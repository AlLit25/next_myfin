(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[549],{907:(e,t,r)=>{"use strict";r.d(t,{E6:()=>l,PD:()=>d,ac:()=>c,b8:()=>o,cI:()=>u,nS:()=>i,w8:()=>n,zl:()=>a});var s=r(5576);function n(e){let t=0;return e.map(e=>{t+=e.sum}),t}function a(e){return e.reduce((e,t)=>{let r=t.created_at,s=t.category,n=t.sum;return e[r]||(e[r]={}),e[r][s]=(e[r][s]||0)+n,e},{})}function i(e){let t={};return Object.keys(e).map(r=>{Object.keys(e[r]).map(s=>{void 0===t[s]?t[s]=Number(e[r][s]):t[s]+=Number(e[r][s])})}),t}function c(e,t){let r=[],s=new Date(e),n=new Date(t);for(;s<=n;)r.push(s.toISOString().split("T")[0]),s.setDate(s.getDate()+1);return r}function l(e,t){let r=[];return Object.keys(t).map(n=>{r.push({name:s.L1[n],value:t[n],percentage:(t[n]/e*100).toFixed(1)})}),r}function o(e){return Object.keys(e).sort((e,t)=>new Date(e)-new Date(t))}function u(e,t){let r=[];return e.map(e=>{e.created_at===t&&r.push(e)}),r}function d(){let e=document.querySelector('button[data-refresh="statistic"]');void 0!==e&&e.click()}},2802:()=>{},4091:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(5155);function n(e){let{header:t=!0}=e;return(0,s.jsxs)("div",{className:"container",children:[t?(0,s.jsx)("div",{className:"m-5 text-center",children:(0,s.jsx)("p",{className:"h1",children:"LiVi Analytics"})}):"",(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"spinner-border text-success",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden"})}),(0,s.jsx)("h3",{children:"Завантаження..."})]})]})}},4680:()=>{},4964:(e,t,r)=>{"use strict";r.d(t,{Ou:()=>u,T5:()=>i,Wv:()=>f,e4:()=>l,h5:()=>o,m8:()=>d,pt:()=>c,r1:()=>x,uo:()=>m});var s=r(2378),n=r(5576);function a(){let e=s.A.get("supabase-auth-token");return e||null}async function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{let r,i=a();try{if(null===i||(r=JSON.parse(i),null===r))return null;{if(!r.access_token||!r.refresh_token)return await goToLogin(e),null;let{data:{session:a},error:i}=await n.DB.auth.setSession({access_token:r.access_token,refresh_token:r.refresh_token});if(!i)return a;{var t;let{data:e,error:a}=await n.DB.auth.refreshSession({refresh_token:r.refresh_token});if(a)return null;return t=e.session,s.A.set("supabase-auth-token",JSON.stringify(t),{expires:1,path:"/",secure:!0,sameSite:"Strict"}),e.session}}}catch(e){return null}}catch(e){return console.error("Помилка перевірки автентифікації:",e.message,e.stack),null}}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(e||window.location.pathname).startsWith("/next_myfin")?"/next_myfin/":"/"}function l(){s.A.remove("supabase-auth-token",{path:"/"})}async function o(e,t){let r={data:null,error:""};try{if(!await i())return r.error="Користувач не авторизований",r;let{data:s,error:a}=await n.DB.from(n.Bt.main).select("*").gte("created_at",e).lte("created_at",t);if(a)return r.error="Помилка отримання даних із ".concat(n.Bt.main,": ")+a.message,r;r.data=s}catch(e){r.error="Виняток у getStatistic: "+e.message}return r}async function u(e,t,r,s,c){try{if(!await i())throw"Користувач не авторизований";let l=JSON.parse(a()),o={sum:t,type:r,user_id:l.user.id,created_at:new Date(e),category:s||null,comment:c||null},{error:u}=await n.DB.from(n.Bt.main).insert([o]);if(u)throw u;return await h(t,r),!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function d(e,t){try{if(!await i())throw"Користувач не авторизований";let r=JSON.parse(a()),s={sum:t,user_id:r.user.id},{error:c}=await n.DB.from(n.Bt.main).update(s).eq("id",e);if(c)throw c;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function h(e,t){let r=await x(),s=0;r.data.id>0&&(s="expense"===t?r.data.uah-Number(e):r.data.uah+Number(e),await m(r.data.id,s))}async function m(e,t){try{if(!await i())throw"Користувач не авторизований";let r=JSON.parse(a()),s={uah:t,user_id:r.user.id,last_check:new Date},{error:c}=await n.DB.from(n.Bt.balance).update(s).eq("id",e);if(c)throw c;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function x(){let e={data:null,error:""};try{if(!await i())return e.error="Користувач не авторизований",e;let t=JSON.parse(a()),{data:r,error:s}=await n.DB.from(n.Bt.balance).select("*").eq("user_id",t.user.id).single();if(s)return e.error="Помилка отримання даних із ".concat(n.Bt.balance,": ")+s.message,e;e.data=r}catch(t){e.error="Виняток у getBalance: "+t.message}return e}async function f(e){try{if(!await i())throw Error("Користувач не авторизований");let t=JSON.parse(a()),{error:r}=await n.DB.from(n.Bt.main).delete().eq("id",e).eq("user_id",t.user.id);if(r)return!1;return!0}catch(e){return!1}}r(87)},5576:(e,t,r)=>{"use strict";r.d(t,{Bt:()=>n,DB:()=>s,L1:()=>a});let s=(0,r(2659).UU)("https://vntunuzrneoakdckqjvk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZudHVudXpybmVvYWtkY2txanZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTI5NzEsImV4cCI6MjA2NzI4ODk3MX0.CWJIVqq-x5_doDk8rsl8ZJWP7um9VakuIDBihcfsrsU"),n={main:"fin_statistic",balance:"fin_balance"},a={pr:"Продукти",cf:"Кафе",cm:"Кумунальні платежі",md:"Аптека",eva:"Eva/Makeup",zoo:"Зоотовари",cl:"Одяг",usd:"Валюта",ot:"Інше"}},7866:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(5155),n=r(2115);function a(e){let{show:t,text:r,setShowDefault:a}=e;return((0,n.useEffect)(()=>{if(t){let e=setTimeout(()=>{a(!1)},2e3);return()=>clearTimeout(e)}},[t]),t||0!==r.length)?(0,s.jsx)("div",{className:"c-modal ".concat(t?"fade-in":"fade-out"),id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,s.jsx)("div",{className:"modal-dialog text-center",children:(0,s.jsx)("div",{className:"alert alert-primary pt-3",role:"alert",children:r})})}):null}},9549:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var s=r(5155),n=r(2253);r(2802),r(4680);var a=r(2115),i=r(4964),c=r(4091);function l(){let[e,t]=(0,a.useState)(0),[r,n]=(0,a.useState)(!0),l=(0,i.pt)();return(0,i.r1)().then(e=>{t(e.data.uah||0),n(!1)}),(0,s.jsx)("div",{children:r?(0,s.jsx)(c.A,{header:!1}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-11",children:(0,s.jsxs)("h2",{children:["Баланс ",e," UAH"]})}),(0,s.jsx)("div",{className:"col-1 pt-2",children:(0,s.jsx)("a",{href:l+"balance",className:"next-btn-inline",children:(0,s.jsx)("svg",{className:"feather feather-chevron-right",fill:"none",height:"24",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("polyline",{points:"9 18 15 12 9 6"})})})})]})})})}var o=r(9582),u=r(5576);function d(){let[e,t]=(0,a.useState)({income:[],expense:[]}),r=(0,o._B)(),[n,l]=(0,a.useState)(!0),d=(0,i.pt)(),h=async(e,r)=>{try{let s=await (0,i.h5)(e,r);if(s.error)t({income:[],expense:[]});else{let e={income:[],expense:[]};(s.data||[]).forEach(t=>{"expense"===t.type?e.expense.push(t):"income"===t.type&&e.income.push(t)}),t(e)}l(!1)}catch(e){location.reload()}};function m(){l(!0),h(r.from,r.to)}return(0,a.useEffect)(()=>{m()},[]),(0,s.jsx)("div",{children:n?(0,s.jsx)(c.A,{header:!1}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-6",children:(0,s.jsx)("h3",{children:(0,o.At)(new Date,"full")})}),(0,s.jsxs)("div",{className:"col-6 text-end",children:[(0,s.jsx)("span",{onClick:m,"data-refresh":"statistic",className:"refresh-icon",children:(0,s.jsx)("svg",{id:"Layer_1",version:"1.1",viewBox:"0 0 32 32",width:"20px",height:"20px",xmlSpace:"preserve",children:(0,s.jsx)("path",{fill:"currentColor",d:"M28,16c-1.219,0-1.797,0.859-2,1.766C25.269,21.03,22.167,26,16,26c-5.523,0-10-4.478-10-10S10.477,6,16,6  c2.24,0,4.295,0.753,5.96,2H20c-1.104,0-2,0.896-2,2s0.896,2,2,2h6c1.104,0,2-0.896,2-2V4c0-1.104-0.896-2-2-2s-2,0.896-2,2v0.518  C21.733,2.932,18.977,2,16,2C8.268,2,2,8.268,2,16s6.268,14,14,14c9.979,0,14-9.5,14-11.875C30,16.672,28.938,16,28,16z"})})}),(0,s.jsx)("a",{href:d+"statistic",className:"next-btn-inline",children:(0,s.jsx)("svg",{className:"feather feather-chevron-right",fill:"none",height:"24",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("polyline",{points:"9 18 15 12 9 6"})})})]})]}),(0,s.jsxs)("div",{children:["Дохід: ",e.income.length>0?(0,s.jsx)("ul",{children:e.income.map(e=>(0,s.jsxs)("li",{children:[e.sum," UAH"]},e.id))}):"відсутній"]}),(0,s.jsxs)("div",{children:["Витрати: ",e.expense.length>0?(0,s.jsx)("ul",{children:e.expense.map(e=>(0,s.jsxs)("li",{children:[e.sum," UAH (",u.L1[e.category],")"]},e.id))}):"відсутні"]}),(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-end"})})]})})}var h=r(7866),m=r(907);function x(e){let{setTextNotify:t,setShowNotify:r}=e,[n,l]=(0,a.useState)(""),[u,d]=(0,a.useState)(!1),h=(0,i.pt)();return(0,s.jsx)("div",{children:u?(0,s.jsx)(c.A,{header:!1}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-8",children:(0,s.jsx)("input",{type:"number",className:"form-control",value:n,placeholder:"сума доходу",onChange:e=>l(e.target.value),min:"0"})}),(0,s.jsxs)("div",{className:"col-4 text-end",children:[(0,s.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){if(d(!0),Number(n)>0){let e=(0,o._B)();(0,i.Ou)(e.from,n,"income","","").then(e=>{r(!0),e?(l(""),t("Данні додано успішно")):t("Не вдалось додати дані"),d(!1),(0,m.PD)()})}else r(!0),t("Поле сумма не може бути порожнім"),d(!1)},children:"Додати дохід"}),(0,s.jsx)("a",{href:h+"income",className:"next-btn-inline",children:(0,s.jsx)("svg",{className:"feather feather-chevron-right",fill:"none",height:"24",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("polyline",{points:"9 18 15 12 9 6"})})})]})]})})})}function f(e){let{setTextNotify:t,setShowNotify:r}=e,[n,l]=(0,a.useState)(!1),[d,h]=(0,a.useState)(""),[x,f]=(0,a.useState)(""),[j,p]=(0,a.useState)(""),v=(0,i.pt)();return(0,s.jsx)("div",{children:n?(0,s.jsx)(c.A,{header:!1}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,s.jsx)("input",{type:"number",className:"i-default form-control",min:"0",placeholder:"сума витрати",value:x,onChange:e=>f(e.target.value)})}),(0,s.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,s.jsxs)("select",{className:"form-control s-default",value:d,onChange:e=>h(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Обрати"},""),Object.entries(u.L1).map(e=>{let[t,r]=e;return(0,s.jsx)("option",{value:t,children:r},t)})]})}),(0,s.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,s.jsx)("textarea",{className:"form-control t-default",onChange:e=>p(e.target.value),value:j})}),(0,s.jsxs)("div",{className:"d-flex justify-content-center mt-3",children:[(0,s.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){if(l(!0),Number(x)>0&&d.length>0){let e=(0,o._B)();(0,i.Ou)(e.from,x,"expense",d,j).then(e=>{r(!0),e?(f(""),p(""),t("Данні додано успішно")):t("Не вдалось додати дані"),l(!1),(0,m.PD)()})}else r(!0),t("Поле категорія та сумма не можуть бути порожніми"),l(!1)},children:"Додати витрату"}),(0,s.jsx)("a",{href:v+"expense",className:"next-btn-inline p-2",children:(0,s.jsx)("svg",{className:"feather feather-chevron-right",fill:"none",height:"24",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("polyline",{points:"9 18 15 12 9 6"})})})]})]})})}function j(){let[e,t]=(0,a.useState)(0),[r,n]=(0,a.useState)(!1),[i,c]=(0,a.useState)(""),o=(0,a.useRef)(null),u=(0,a.useRef)(0),m=(0,a.useRef)(0),j=(0,a.useRef)(!1);return(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)(h.A,{show:r,text:i,setShowDefault:n}),(0,s.jsxs)("div",{className:"col-12",children:[(0,s.jsx)("div",{className:"slider-container",children:(0,s.jsxs)("div",{className:"slider-track d-flex",ref:o,style:{transform:"translateX(-".concat(50*e,"%)")},onTouchStart:e=>{u.current=e.touches[0].clientX,m.current=u.current,j.current=!0,o.current&&(o.current.style.transition="none")},onTouchMove:t=>{if(!j.current)return;m.current=t.touches[0].clientX;let r=-(50*e)+(m.current-u.current)/window.innerWidth*100;o.current&&(o.current.style.transform="translateX(".concat(r,"%)"))},onTouchEnd:()=>{if(!j.current)return;j.current=!1,o.current&&(o.current.style.transition="transform 0.3s ease-in-out");let r=m.current-u.current,s=e;Math.abs(r)>50&&(r>0&&e>0?s=e-1:r<0&&e<1&&(s=e+1)),t(s),o.current&&(o.current.style.transform="translateX(-".concat(50*s,"%)"))},children:[(0,s.jsxs)("div",{className:"slide p-3",children:[(0,s.jsx)("div",{className:"d-block-desk",style:{width:"100%"},children:(0,s.jsx)(l,{})}),(0,s.jsx)("div",{className:"d-block-desk mt-3",style:{width:"100%"},children:(0,s.jsx)(d,{})})]}),(0,s.jsxs)("div",{className:"slide p-3",children:[(0,s.jsx)("div",{className:"d-block-desk",style:{width:"100%"},children:(0,s.jsx)(x,{setTextNotify:c,setShowNotify:n})}),(0,s.jsx)("div",{className:"d-block-desk mt-3",style:{width:"100%"},children:(0,s.jsx)(f,{setTextNotify:c,setShowNotify:n})})]})]})}),(0,s.jsx)("div",{className:"dots",children:[0,1].map(r=>(0,s.jsx)("span",{className:"dot ".concat(e===r?"active":""),onClick:()=>t(r)},r))})]})]})}function p(){let[e,t]=(0,a.useState)(!1),[r,n]=(0,a.useState)("");return(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)(h.A,{show:e,text:r,setShowDefault:t}),(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("div",{className:"d-block-desk",children:(0,s.jsx)(l,{})}),(0,s.jsx)("div",{className:"d-block-desk mt-2",children:(0,s.jsx)(d,{})})]}),(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("div",{className:"d-block-desk mt-2",children:(0,s.jsx)(x,{setTextNotify:n,setShowNotify:t})}),(0,s.jsx)("div",{className:"d-block-desk mt-2",children:(0,s.jsx)(f,{setTextNotify:n,setShowNotify:t})})]})]})}function v(){return(0,s.jsx)("div",{children:n.Fr?(0,s.jsx)(j,{}):(0,s.jsx)(p,{})})}},9582:(e,t,r)=>{"use strict";function s(){let e=new Date,t=new Date(e);return t.setDate(e.getDate()+1),{from:a(e),to:a(t)}}function n(){let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),r=new Date(e.getFullYear(),e.getMonth()+1,0);return{from:a(t),to:a(r)}}function a(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(s)}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),a=e.getDay(),i="";return"short"===t?i=["Нд","Пн","Вт","Ср","Чт","Пт","Сб"][a]+", ":"full"===t&&(i=["Неділя","Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота"][a]+", "),i+"".concat(n,".").concat(s,".").concat(r)}r.d(t,{At:()=>i,Ew:()=>n,_B:()=>s})}}]);