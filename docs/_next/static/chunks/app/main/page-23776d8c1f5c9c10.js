(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{1559:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});var a=r(5155),n=r(2115),s=r(9582),i=r(4964),c=r(4091),l=r(5576);function o(){let[e,t]=(0,n.useState)({income:[],expense:[]}),r=(0,s._B)(),[o,u]=(0,n.useState)(!0),d=async(r,a)=>{try{let n=await (0,i.h5)(r,a);if(n.error)t({income:[],expense:[]});else{let r={income:[],expense:[]};(n.data||[]).forEach(e=>{"expense"===e.type?r.expense.push(e):"income"===e.type&&r.income.push(e)}),t(r),console.log(e),console.log(r)}u(!1)}catch(e){location.reload()}};return(0,n.useEffect)(()=>{d(r.from,r.to)},[]),(0,a.jsx)("div",{children:o?(0,a.jsx)(c.A,{header:!1}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"row",children:[(0,a.jsx)("h3",{className:"col-8",children:(0,s.At)(new Date,"full")}),(0,a.jsx)("a",{className:"col-4 text-end",href:"/statistic",children:"Детально"})]}),(0,a.jsxs)("div",{children:["Дохід: ",e.income.length>0?(0,a.jsx)("ul",{children:e.income.map(e=>(0,a.jsxs)("li",{children:[e.sum," UAH"]},e.id))}):"відсутній"]}),(0,a.jsxs)("div",{children:["Витрати: ",e.expense.length>0?(0,a.jsx)("ul",{children:e.expense.map(e=>(0,a.jsxs)("li",{children:[e.sum," UAH (",l.L1[e.category],")"]},e.id))}):"відсутні"]}),(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"text-end"})})]})})}},1783:(e,t,r)=>{"use strict";r.d(t,{default:()=>c});var a=r(5155),n=r(2115),s=r(4964),i=r(4091);function c(){let[e,t]=(0,n.useState)(0),[r,c]=(0,n.useState)(!0);return(0,s.r1)().then(e=>{t(e.data.uah||0),c(!1)}),(0,a.jsx)("div",{children:r?(0,a.jsx)(i.A,{header:!1}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"row",children:[(0,a.jsxs)("h2",{className:"col-8",children:["Баланс ",e," UAH"]}),(0,a.jsx)("a",{className:"col-4 text-end",href:"/balance",children:"Звірити"})]})})})}},1980:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2619,23)),Promise.resolve().then(r.t.bind(r,2802,23)),Promise.resolve().then(r.bind(r,1783)),Promise.resolve().then(r.bind(r,9399)),Promise.resolve().then(r.bind(r,1559))},2802:()=>{},4091:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(5155);function n(e){let{header:t=!0}=e;return(0,a.jsxs)("div",{className:"container",children:[t?(0,a.jsx)("div",{className:"m-5 text-center",children:(0,a.jsx)("p",{className:"h1",children:"LiVi Analytics"})}):"",(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"spinner-border text-success",role:"status",children:(0,a.jsx)("span",{className:"visually-hidden"})}),(0,a.jsx)("h3",{children:"Завантаження..."})]})]})}},4964:(e,t,r)=>{"use strict";r.d(t,{Ou:()=>d,T5:()=>i,Wv:()=>p,e4:()=>o,h5:()=>u,m8:()=>h,pt:()=>l,r1:()=>x,uo:()=>f});var a=r(2378),n=r(5576);function s(){let e=a.A.get("supabase-auth-token");return e||null}async function i(){try{let t,r=s();try{if(t=JSON.parse(r),null!==t){t.access_token&&t.refresh_token||c();let{data:{session:r},error:s}=await n.DB.auth.setSession({access_token:t.access_token,refresh_token:t.refresh_token});if(!s)return r;{var e;let{data:s,error:i}=await n.DB.auth.refreshSession({refresh_token:t.refresh_token});return i?c():(e=r,a.A.set("supabase-auth-token",JSON.stringify(e),{expires:1,path:"/",secure:!0,sameSite:"Strict"})),s.session}}c()}catch(e){c()}}catch(e){console.error("Помилка перевірки автентифікації:",e.message,e.line),c()}}function c(){let e=location.pathname,t=l();e!==t&&(location.href=t)}function l(){return location.pathname.startsWith("/next_myfin")?"/next_myfin/":"/"}function o(){a.A.remove("supabase-auth-token",{path:"/"})}async function u(e,t){let r={data:null,error:""};try{if(!await i())return r.error="Користувач не авторизований",r;let{data:a,error:s}=await n.DB.from(n.Bt.main).select("*").gte("created_at",e).lte("created_at",t);if(s)return r.error="Помилка отримання даних із ".concat(n.Bt.main,": ")+s.message,r;r.data=a}catch(e){r.error="Виняток у getStatistic: "+e.message}return r}async function d(e,t,r,a,c){try{if(!await i())throw"Користувач не авторизований";let l=JSON.parse(s()),o={sum:t,type:r,user_id:l.user.id,created_at:new Date(e),category:a||null,comment:c||null},{error:u}=await n.DB.from(n.Bt.main).insert([o]);if(u)throw u;return await m(t,r),!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function h(e,t){try{if(!await i())throw"Користувач не авторизований";let r=JSON.parse(s()),a={sum:t,user_id:r.user.id},{error:c}=await n.DB.from(n.Bt.main).update(a).eq("id",e);if(c)throw c;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function m(e,t){let r=await x(),a=0;r.data.id>0&&(a="expense"===t?r.data.uah-Number(e):r.data.uah+Number(e),await f(r.data.id,a))}async function f(e,t){try{if(!await i())throw"Користувач не авторизований";let r=JSON.parse(s()),a={uah:t,user_id:r.user.id,last_check:new Date},{error:c}=await n.DB.from(n.Bt.balance).update(a).eq("id",e);if(c)throw c;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function x(){let e={data:null,error:""};try{if(!await i())return e.error="Користувач не авторизований",e;let t=JSON.parse(s()),{data:r,error:a}=await n.DB.from(n.Bt.balance).select("*").eq("user_id",t.user.id).single();if(a)return e.error="Помилка отримання даних із ".concat(n.Bt.balance,": ")+a.message,e;e.data=r}catch(t){e.error="Виняток у getBalance: "+t.message}return e}async function p(e){try{if(!await i())throw Error("Користувач не авторизований");let t=JSON.parse(s()),{error:r}=await n.DB.from(n.Bt.main).delete().eq("id",e).eq("user_id",t.user.id);if(r)return!1;return!0}catch(e){return!1}}},5576:(e,t,r)=>{"use strict";r.d(t,{Bt:()=>n,DB:()=>a,L1:()=>s});let a=(0,r(2659).UU)("https://vntunuzrneoakdckqjvk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZudHVudXpybmVvYWtkY2txanZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTI5NzEsImV4cCI6MjA2NzI4ODk3MX0.CWJIVqq-x5_doDk8rsl8ZJWP7um9VakuIDBihcfsrsU"),n={main:"fin_statistic",balance:"fin_balance"},s={pr:"Продукти",cf:"Кафе",cm:"Кумунальні платежі",md:"Аптека",eva:"Eva/Makeup",zoo:"Зоотовари",cl:"Одяг",usd:"Валюта",ot:"Інше"}},7866:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(5155),n=r(2115);function s(e){let{show:t,text:r,setShowDefault:s}=e;return((0,n.useEffect)(()=>{if(t){let e=setTimeout(()=>{s(!1)},2e3);return()=>clearTimeout(e)}},[t]),t||0!==r.length)?(0,a.jsx)("div",{className:"c-modal ".concat(t?"fade-in":"fade-out"),id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,a.jsx)("div",{className:"modal-dialog text-center",children:(0,a.jsx)("div",{className:"alert alert-primary pt-3",role:"alert",children:r})})}):null}},9399:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});var a=r(5155),n=r(4091),s=r(2115),i=r(4964),c=r(9582),l=r(7866);function o(){let[e,t]=(0,s.useState)(""),[r,o]=(0,s.useState)(!1),[u,d]=(0,s.useState)(""),[h,m]=(0,s.useState)(!1);return(0,a.jsx)("div",{children:h?(0,a.jsx)(n.A,{header:!1}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"row",children:[(0,a.jsx)(l.A,{show:r,text:u,setShowDefault:o}),(0,a.jsx)("div",{className:"mt-3 text-center",children:(0,a.jsx)("h1",{children:"Додати дохід"})}),(0,a.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,a.jsx)("input",{type:"number",className:"i-default form-control",value:e,onChange:e=>t(e.target.value),min:"0"})}),(0,a.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,a.jsx)("button",{type:"button",className:"btn btn-success b-default",onClick:function(){if(m(!0),Number(e)>0){let r=(0,c._B)();(0,i.Ou)(r.from,e,"income","","").then(e=>{o(!0),e?(t(""),d("Данні додано успішно")):d("Не вдалось додати дані"),m(!1)})}else o(!0),d("Поле сумма не може бути порожнім"),m(!1)},children:"Додати"})})]})})})}},9582:(e,t,r)=>{"use strict";function a(){let e=new Date,t=new Date(e);return t.setDate(e.getDate()+1),{from:s(e),to:s(t)}}function n(){let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),r=new Date(e.getFullYear(),e.getMonth()+1,0);return{from:s(t),to:s(r)}}function s(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(a)}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),s=e.getDay(),i="";return"short"===t?i=["Нд","Пн","Вт","Ср","Чт","Пт","Сб"][s]+", ":"full"===t&&(i=["Неділя","Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота"][s]+", "),i+"".concat(n,".").concat(a,".").concat(r)}r.d(t,{At:()=>i,Ew:()=>n,_B:()=>a})}},e=>{e.O(0,[317,779,441,255,358],()=>e(e.s=1980)),_N_E=e.O()}]);