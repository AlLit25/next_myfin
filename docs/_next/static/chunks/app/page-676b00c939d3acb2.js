(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1079:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>h});var s=t(5155),a=t(2115),n=t(4964),c=t(63),i=t(5576),l=t(2378);function o(){let[e,r]=(0,a.useState)(""),[t,n]=(0,a.useState)(""),[o,u]=(0,a.useState)(null);(0,c.useRouter)();let d=async r=>{r.preventDefault(),u(null);try{let{data:r,error:s}=await i.DB.auth.signInWithPassword({email:e,password:t});if(s)return void u(s.message);l.A.set("supabase-auth-token",JSON.stringify(r.session),{expires:1,path:"/",secure:!0,sameSite:"Strict"}),location.reload()}catch(e){u("Помилка авторизації: "+e.message)}};return(0,s.jsx)("div",{className:"d-block",children:(0,s.jsxs)("form",{onSubmit:d,children:[o&&(0,s.jsx)("div",{className:"alert alert-danger",children:o}),(0,s.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,s.jsxs)("div",{className:"w-50",children:[(0,s.jsx)("label",{className:"form-label",children:"Email"}),(0,s.jsx)("input",{className:"form-control form-control-lg",type:"email",placeholder:"email@com.ua",value:e,onChange:e=>r(e.target.value),required:!0})]})}),(0,s.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,s.jsxs)("div",{className:"w-50",children:[(0,s.jsx)("label",{className:"form-label",children:"Пароль"}),(0,s.jsx)("input",{className:"form-control form-control-lg",type:"password",placeholder:"",value:t,onChange:e=>n(e.target.value),required:!0})]})}),(0,s.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Увійти"})})]})})}var u=t(8148);function d(){return(0,s.jsxs)("div",{className:"d-block",children:[(0,s.jsx)(u.A,{href:"/income",color:"primary",text:"Дохід"}),(0,s.jsx)(u.A,{href:"/expense",color:"primary",text:"Витрати"}),(0,s.jsx)(u.A,{href:"/statistic",color:"primary",text:"Статистика"}),(0,s.jsx)(u.A,{href:"/balance",color:"primary",text:"Баланс"})]})}var m=t(4091);function h(){let[e,r]=(0,a.useState)(!1),[t,c]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{!async function(){try{await (0,n.T5)()?r(!0):((0,n.e4)(),r(!1)),c(!1)}catch(e){(0,n.e4)(),r(!1),c(!1)}}()},[]),t)?(0,s.jsx)(m.A,{}):(0,s.jsxs)("div",{className:"container",children:[(0,s.jsx)("div",{className:"m-5 text-center",children:(0,s.jsx)("p",{className:"h1",children:"LiVi Analytics"})}),e?(0,s.jsx)(d,{}):(0,s.jsx)(o,{})]})}},2979:(e,r,t)=>{Promise.resolve().then(t.bind(t,1079))},4091:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});var s=t(5155);function a(e){let{header:r=!0}=e;return(0,s.jsxs)("div",{className:"container",children:[r?(0,s.jsx)("div",{className:"m-5 text-center",children:(0,s.jsx)("p",{className:"h1",children:"LiVi Analytics"})}):"",(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"spinner-border text-success",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden"})}),(0,s.jsx)("h3",{children:"Завантаження..."})]})]})}},4964:(e,r,t)=>{"use strict";t.d(r,{Ou:()=>u,T5:()=>i,e4:()=>l,h5:()=>o,r1:()=>m,uo:()=>d});var s=t(2378),a=t(5576),n=t(63);function c(){let e=s.A.get("supabase-auth-token");return e||null}async function i(){try{let r,t=c();try{(r=JSON.parse(t)).access_token&&r.refresh_token||(0,n.redirect)("/")}catch(e){(0,n.redirect)("/")}let{data:{session:i},error:l}=await a.DB.auth.setSession({access_token:r.access_token,refresh_token:r.refresh_token});if(!l)return i;{var e;let{data:t,error:c}=await a.DB.auth.refreshSession({refresh_token:r.refresh_token});return c?(0,n.redirect)("/"):(e=i,s.A.set("supabase-auth-token",JSON.stringify(e),{expires:1,path:"/",secure:!0,sameSite:"Strict"})),t.session}}catch(e){console.error("Помилка перевірки автентифікації:",e.message,e.line),(0,n.redirect)("/")}}function l(){s.A.remove("supabase-auth-token",{path:"/"})}async function o(e,r){let t={data:null,error:""};try{if(!await i())return t.error="Користувач не авторизований",t;let{data:s,error:n}=await a.DB.from(a.B.main).select("*").gte("created_at",e).lte("created_at",r);if(n)return t.error="Помилка отримання даних із ".concat(a.B.main,": ")+n.message,t;t.data=s}catch(e){t.error="Виняток у getStatistic: "+e.message}return t}async function u(e,r,t,s,n){try{if(!await i())throw"Користувач не авторизований";let l=JSON.parse(c()),o={sum:r,type:t,user_id:l.user.id,created_at:new Date(e),category:s||null,comment:n||null},{error:u}=await a.DB.from(a.B.main).insert([o]);if(u)throw u;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function d(e,r){try{if(!await i())throw"Користувач не авторизований";let t=JSON.parse(c()),s={uah:r,user_id:t.user.id,last_check:new Date},{error:n}=await a.DB.from(a.B.balance).update(s).eq("id",e);if(n)throw n;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function m(){let e={data:null,error:""};try{if(!await i())return e.error="Користувач не авторизований",e;let r=JSON.parse(c()),{data:t,error:s}=await a.DB.from(a.B.balance).select("*").eq("user_id",r.user.id).single();if(s)return e.error="Помилка отримання даних із ".concat(a.B.balance,": ")+s.message,e;e.data=t}catch(r){e.error="Виняток у getBalance: "+r.message}return e}},5576:(e,r,t)=>{"use strict";t.d(r,{B:()=>a,DB:()=>s,L:()=>n});let s=(0,t(2659).UU)("https://vntunuzrneoakdckqjvk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZudHVudXpybmVvYWtkY2txanZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTI5NzEsImV4cCI6MjA2NzI4ODk3MX0.CWJIVqq-x5_doDk8rsl8ZJWP7um9VakuIDBihcfsrsU"),a={main:"fin_statistic",balance:"fin_balance"},n={pr:"Продукти",cf:"Кафе",cm:"Кумунальні платежі",md:"Аптека",eva:"Eva/Makeup",zoo:"Зоотовари",cl:"Одяг",usd:"Валюта",ot:"Інше"}},8148:(e,r,t)=>{"use strict";t.d(r,{A:()=>c});var s=t(5155),a=t(2619),n=t.n(a);function c(e){let{href:r,text:t,color:a}=e;return(0,s.jsx)("div",{className:"text-center p-2",children:(0,s.jsx)(n(),{href:r,className:"btn btn-".concat(a," btn-menu fs-4 fw-bold"),children:t})})}}},e=>{e.O(0,[76,441,255,358],()=>e(e.s=2979)),_N_E=e.O()}]);