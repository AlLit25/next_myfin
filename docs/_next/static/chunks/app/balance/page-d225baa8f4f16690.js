(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[977],{4091:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(5155);function s(e){let{header:t=!0}=e;return(0,r.jsxs)("div",{className:"container",children:[t?(0,r.jsx)("div",{className:"m-5 text-center",children:(0,r.jsx)("p",{className:"h1",children:"LiVi Analytics"})}):"",(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"spinner-border text-success",role:"status",children:(0,r.jsx)("span",{className:"visually-hidden"})}),(0,r.jsx)("h3",{children:"Завантаження..."})]})]})}},4964:(e,t,a)=>{"use strict";a.d(t,{Ou:()=>o,T5:()=>c,Wv:()=>m,_W:()=>x,e4:()=>l,h5:()=>u,m8:()=>d,pt:()=>i,r1:()=>p,uo:()=>f});var r=a(2378),s=a(5576);function n(){let e=r.A.get("supabase-auth-token");return e||null}async function c(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let t,a=n();try{if(null===a||(t=JSON.parse(a),null===t))return null;{if(!t.access_token||!t.refresh_token)return null;let{data:{session:a},error:n}=await s.DB.auth.setSession({access_token:t.access_token,refresh_token:t.refresh_token});if(!n)return a;{var e;let{data:a,error:n}=await s.DB.auth.refreshSession({refresh_token:t.refresh_token});if(n)return null;return e=a.session,r.A.set("supabase-auth-token",JSON.stringify(e),{expires:1,path:"/",secure:!0,sameSite:"Strict"}),a.session}}}catch(e){return null}}catch(e){return console.error("Помилка перевірки автентифікації:",e.message,e.stack),null}}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(e||window.location.pathname).startsWith("/next_myfin")?"/next_myfin/":"/"}function l(){r.A.remove("supabase-auth-token",{path:"/"})}async function u(e,t){let a={data:null,error:""};try{if(!await c())return a.error="Користувач не авторизований",a;let{data:r,error:n}=await s.DB.from(s.Bt.main).select("*").gte("created_at",e).lte("created_at",t);if(n)return a.error="Помилка отримання даних із ".concat(s.Bt.main,": ")+n.message,a;a.data=r}catch(e){a.error="Виняток у getStatistic: "+e.message}return a}async function o(e,t,a,r,i){try{if(!await c())throw"Користувач не авторизований";let l=JSON.parse(n()),u={sum:t,type:a,user_id:l.user.id,created_at:new Date(e),category:r||null,comment:i||null},{error:o}=await s.DB.from(s.Bt.main).insert([u]);if(o)throw o;return await h(t,a),!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function d(e,t){try{if(!await c())throw"Користувач не авторизований";let a=JSON.parse(n()),r={sum:t,user_id:a.user.id},{error:i}=await s.DB.from(s.Bt.main).update(r).eq("id",e);if(i)throw i;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function m(e){try{if(!await c())throw Error("Користувач не авторизований");let t=JSON.parse(n()),{error:a}=await s.DB.from(s.Bt.main).delete().eq("id",e).eq("user_id",t.user.id);if(a)return!1;return!0}catch(e){return!1}}async function h(e,t){let a=await p();a.data.id>0&&(a.data.uah,await f(a.data.id))}async function f(e,t){try{if(!await c())throw"Користувач не авторизований";let a=JSON.parse(n()),r={uah:t,user_id:a.user.id},{error:i}=await s.DB.from(s.Bt.balance).update(r).eq("id",e);if(i)throw i;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function x(e,t){try{if(!await c())throw"Користувач не авторизований";let a=JSON.parse(n()),r={usd:t,user_id:a.user.id},{error:i}=await s.DB.from(s.Bt.balance).update(r).eq("id",e);if(i)throw i;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function p(){let e={data:null,error:""};try{if(!await c())return e.error="Користувач не авторизований",e;let t=JSON.parse(n()),{data:a,error:r}=await s.DB.from(s.Bt.balance).select("*").eq("user_id",t.user.id).eq("type","current").single();if(r)return e.error="Помилка отримання даних із ".concat(s.Bt.balance,": ")+r.message,e;e.data=a}catch(t){e.error="Виняток у getBalance: "+t.message}return e}},5484:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(5155),s=a(8148),n=a(2115),c=a(4964),i=a(4091),l=a(7866);function u(){let[e,t]=(0,n.useState)(0),[a,u]=(0,n.useState)([{id:Date.now(),value:0}]),[o,d]=(0,n.useState)(0),[m,h]=(0,n.useState)(0),[f,x]=(0,n.useState)(0),[p,j]=(0,n.useState)(!0),[b,N]=(0,n.useState)(!1),[v,y]=(0,n.useState)(""),[w,k]=(0,n.useState)(42.05);return(0,n.useEffect)(()=>{(0,c.r1)().then(e=>{null!==e.data&&(d(e.data.uah||0),h(Number(e.data.usd)||0),x(e.data.id||0)),j(!1)})},[]),p?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"d-block",children:(0,r.jsx)(s.A,{href:"/",color:"secondary",text:"На головну"})}),(0,r.jsx)(i.A,{header:!1})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)(l.A,{show:b,text:v,setShowDefault:N}),(0,r.jsx)("div",{className:"d-block",children:(0,r.jsx)(s.A,{href:"/",color:"secondary",text:"На головну"})}),(0,r.jsx)("div",{className:"mt-3 text-center",children:(0,r.jsxs)("h1",{children:["Баланс ",o," UAH"]})}),(0,r.jsx)("div",{className:"d-block text-center",children:(0,r.jsxs)("p",{children:["Перевірка баланс: ",e," UAH"]})}),(0,r.jsx)("div",{className:"mt-3 text-center",children:(0,r.jsx)("h4",{children:"Звірити"})}),(0,r.jsx)("div",{className:"d-block",children:a.map((e,s)=>(0,r.jsxs)("div",{className:"d-flex justify-content-center mt-3",children:[(0,r.jsx)("input",{type:"number",className:"i-default form-control",value:e.value||"",onChange:e=>(function(e,r){let s=[...a];s[r].value=Number(e),u(s),t(s.reduce((e,t)=>e+t.value,0))})(e.target.value,s),min:"0"}),(0,r.jsx)("span",{className:"m-2",children:(0,r.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",disabled:1===a.length,onClick:()=>(function(e){if(a.length>1){let r=a.filter(t=>t.id!==e);u(r),t(r.reduce((e,t)=>e+t.value,0))}})(e.id)})})]},e.id))}),(0,r.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,r.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){u([...a,{id:Date.now(),value:0}])},children:"Додати ще"})}),(0,r.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,r.jsxs)("p",{children:["Різниця: ",(0,r.jsx)("span",{className:"error-color",children:e-o})," UAH"]})}),(0,r.jsx)("div",{className:"d-flex justify-content-center",children:(0,r.jsx)("button",{type:"button",className:"btn btn-success b-default",onClick:function(){(e-o==0||confirm("Різниція не дорівнює 0. Продовжити?"))&&(0,c.uo)(f,e).then(e=>{N(!0),e?y("Дані оновлено"):y("Не вдалось оновити дані")})},children:(0,r.jsx)("b",{children:"Записати"})})}),(0,r.jsxs)("div",{className:"d-flex justify-content-center mt-5",children:[(0,r.jsx)("span",{className:"m-2",children:"USD"}),(0,r.jsx)("input",{type:"number",className:"form-control",style:{width:"130px"},value:m,onChange:e=>h(e.target.value),min:"0"}),(0,r.jsx)("button",{className:"btn btn-success m-1",onClick:function(){(0,c._W)(f,m).then(e=>{N(!0),e?y("Дані оновлено"):y("Не вдалось оновити дані")})},children:"Оновити"})]}),(0,r.jsxs)("div",{className:"d-flex justify-content-center m-1",children:[(0,r.jsx)("span",{className:"m-2",children:"Курс"}),(0,r.jsx)("input",{type:"number",className:"form-control",style:{width:"100px"},value:w,onChange:e=>k(e.target.value),min:"0"}),(0,r.jsxs)("span",{className:"m-2",children:[" У гривні: ",m*w]})]})]})}},5576:(e,t,a)=>{"use strict";a.d(t,{Bt:()=>s,DB:()=>r,L1:()=>n});let r=(0,a(2659).UU)("https://vntunuzrneoakdckqjvk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZudHVudXpybmVvYWtkY2txanZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTI5NzEsImV4cCI6MjA2NzI4ODk3MX0.CWJIVqq-x5_doDk8rsl8ZJWP7um9VakuIDBihcfsrsU"),s={main:"fin_statistic",balance:"fin_balance"},n={pr:"Продукти",cf:"Кафе",cm:"Кумунальні платежі",md:"Аптека",eva:"Eva/Makeup",zoo:"Зоотовари",cl:"Одяг",usd:"Валюта",ot:"Інше"}},7866:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(5155),s=a(2115);function n(e){let{show:t,text:a,setShowDefault:n}=e;return((0,s.useEffect)(()=>{if(t){let e=setTimeout(()=>{n(!1)},2e3);return()=>clearTimeout(e)}},[t]),t||0!==a.length)?(0,r.jsx)("div",{className:"c-modal ".concat(t?"fade-in":"fade-out"),id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,r.jsx)("div",{className:"modal-dialog text-center",children:(0,r.jsx)("div",{className:"alert alert-primary pt-3",role:"alert",children:a})})}):null}},8148:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var r=a(5155),s=a(2619),n=a.n(s);function c(e){let{href:t,text:a,color:s}=e;return(0,r.jsx)("div",{className:"text-center p-2",children:(0,r.jsx)(n(),{href:t,className:"btn btn-".concat(s," btn-menu fs-4 fw-bold"),children:a})})}},8554:(e,t,a)=>{Promise.resolve().then(a.bind(a,5484))}},e=>{e.O(0,[779,441,255,358],()=>e(e.s=8554)),_N_E=e.O()}]);