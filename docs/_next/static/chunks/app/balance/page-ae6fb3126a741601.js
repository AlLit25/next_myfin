(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[977],{4091:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(5155);function a(e){let{header:t=!0}=e;return(0,s.jsxs)("div",{className:"container",children:[t?(0,s.jsx)("div",{className:"m-5 text-center",children:(0,s.jsx)("p",{className:"h1",children:"LiVi Analytics"})}):"",(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"spinner-border text-success",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden"})}),(0,s.jsx)("h3",{children:"Завантаження..."})]})]})}},4964:(e,t,r)=>{"use strict";r.d(t,{Ou:()=>u,T5:()=>i,e4:()=>l,h5:()=>d,r1:()=>h,uo:()=>o});var s=r(2378),a=r(5576),n=r(63);function c(){let e=s.A.get("supabase-auth-token");return e||null}async function i(){try{let t,r=c();try{(t=JSON.parse(r)).access_token&&t.refresh_token||(0,n.redirect)("/")}catch(e){(0,n.redirect)("/")}let{data:{session:i},error:l}=await a.DB.auth.setSession({access_token:t.access_token,refresh_token:t.refresh_token});if(!l)return i;{var e;let{data:r,error:c}=await a.DB.auth.refreshSession({refresh_token:t.refresh_token});return c?(0,n.redirect)("/"):(e=i,s.A.set("supabase-auth-token",JSON.stringify(e),{expires:1,path:"/",secure:!0,sameSite:"Strict"})),r.session}}catch(e){console.error("Помилка перевірки автентифікації:",e.message,e.line),(0,n.redirect)("/")}}function l(){s.A.remove("supabase-auth-token",{path:"/"})}async function d(e,t){let r={data:null,error:""};try{if(!await i())return r.error="Користувач не авторизований",r;let{data:s,error:n}=await a.DB.from(a.B.main).select("*").gte("created_at",e).lte("created_at",t);if(n)return r.error="Помилка отримання даних із ".concat(a.B.main,": ")+n.message,r;r.data=s}catch(e){r.error="Виняток у getStatistic: "+e.message}return r}async function u(e,t,r,s,n){try{if(!await i())throw"Користувач не авторизований";let l=JSON.parse(c()),d={sum:t,type:r,user_id:l.user.id,created_at:new Date(e),category:s||null,comment:n||null},{error:u}=await a.DB.from(a.B.main).insert([d]);if(u)throw u;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function o(e,t){try{if(!await i())throw"Користувач не авторизований";let r=JSON.parse(c()),s={uah:t,user_id:r.user.id,last_check:new Date},{error:n}=await a.DB.from(a.B.balance).update(s).eq("id",e);if(n)throw n;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function h(){let e={data:null,error:""};try{if(!await i())return e.error="Користувач не авторизований",e;let t=JSON.parse(c()),{data:r,error:s}=await a.DB.from(a.B.balance).select("*").eq("user_id",t.user.id).single();if(s)return e.error="Помилка отримання даних із ".concat(a.B.balance,": ")+s.message,e;e.data=r}catch(t){e.error="Виняток у getBalance: "+t.message}return e}},5484:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(5155),a=r(8148),n=r(2115),c=r(4964),i=r(4091),l=r(7866);function d(){let[e,t]=(0,n.useState)(0),[r,d]=(0,n.useState)([{id:Date.now(),value:0}]),[u,o]=(0,n.useState)(0),[h,m]=(0,n.useState)(0),[f,x]=(0,n.useState)(!0),[j,b]=(0,n.useState)(!1),[v,p]=(0,n.useState)("");return(0,c.r1)().then(e=>{o(e.data.uah||0),m(e.data.id||0),x(!1)}),f?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mt-3 text-center",children:(0,s.jsx)("h1",{children:"Баланс 0 UAH"})}),(0,s.jsx)("div",{className:"d-block",children:(0,s.jsx)(a.A,{href:"/",color:"secondary",text:"На головну"})}),(0,s.jsx)(i.A,{header:!1})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)(l.A,{show:j,text:v,setShowDefault:b}),(0,s.jsx)("div",{className:"mt-3 text-center",children:(0,s.jsxs)("h1",{children:["Баланс ",u," UAH"]})}),(0,s.jsx)("div",{className:"d-block",children:(0,s.jsx)(a.A,{href:"/",color:"secondary",text:"На головну"})}),(0,s.jsx)("div",{className:"d-block text-center",children:(0,s.jsxs)("p",{children:["Перевірка баланс: ",e," UAH"]})}),(0,s.jsx)("div",{className:"mt-3 text-center",children:(0,s.jsx)("h4",{children:"Звірити"})}),(0,s.jsx)("div",{className:"d-block",children:r.map((e,a)=>(0,s.jsxs)("div",{className:"d-flex justify-content-center mt-3",children:[(0,s.jsx)("input",{type:"number",className:"i-default form-control",value:e.value||"",onChange:e=>(function(e,s){let a=[...r];a[s].value=Number(e),d(a),t(a.reduce((e,t)=>e+t.value,0))})(e.target.value,a),min:"0"}),(0,s.jsx)("span",{className:"m-2",children:(0,s.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",disabled:1===r.length,onClick:()=>(function(e){if(r.length>1){let s=r.filter(t=>t.id!==e);d(s),t(s.reduce((e,t)=>e+t.value,0))}})(e.id)})})]},e.id))}),(0,s.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,s.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){d([...r,{id:Date.now(),value:0}])},children:"Додати ще"})}),(0,s.jsx)("div",{className:"d-flex justify-content-center mt-5",children:(0,s.jsxs)("p",{children:["Різниця: ",(0,s.jsx)("span",{className:"error-color",children:e-u})," UAH"]})}),(0,s.jsx)("div",{className:"d-flex justify-content-center mt-5",children:(0,s.jsx)("button",{type:"button",className:"btn btn-success b-default",onClick:function(){(e-u==0||confirm("Різниція не дорівнює 0. Продовжити?"))&&(0,c.uo)(h,e).then(e=>{b(!0),e?p("Дані оновлено"):p("Не вдалось оновити дані")})},children:(0,s.jsx)("b",{children:"Записати"})})})]})}},5576:(e,t,r)=>{"use strict";r.d(t,{B:()=>a,DB:()=>s,L:()=>n});let s=(0,r(2659).UU)("https://vntunuzrneoakdckqjvk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZudHVudXpybmVvYWtkY2txanZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTI5NzEsImV4cCI6MjA2NzI4ODk3MX0.CWJIVqq-x5_doDk8rsl8ZJWP7um9VakuIDBihcfsrsU"),a={main:"fin_statistic",balance:"fin_balance"},n={pr:"Продукти",cf:"Кафе",cm:"Кумунальні платежі",md:"Аптека",eva:"Eva/Makeup",zoo:"Зоотовари",cl:"Одяг",usd:"Валюта",ot:"Інше"}},7866:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(5155),a=r(2115);function n(e){let{show:t,text:r,setShowDefault:n}=e;return((0,a.useEffect)(()=>{if(t){let e=setTimeout(()=>{n(!1)},2e3);return()=>clearTimeout(e)}},[t]),t||0!==r.length)?(0,s.jsx)("div",{className:"c-modal ".concat(t?"fade-in":"fade-out"),id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,s.jsx)("div",{className:"modal-dialog text-center",children:(0,s.jsx)("div",{className:"alert alert-primary pt-3",role:"alert",children:r})})}):null}},8148:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(5155),a=r(2619),n=r.n(a);function c(e){let{href:t,text:r,color:a}=e;return(0,s.jsx)("div",{className:"text-center p-2",children:(0,s.jsx)(n(),{href:t,className:"btn btn-".concat(a," btn-menu fs-4 fw-bold"),children:r})})}},8554:(e,t,r)=>{Promise.resolve().then(r.bind(r,5484))}},e=>{e.O(0,[76,441,255,358],()=>e(e.s=8554)),_N_E=e.O()}]);