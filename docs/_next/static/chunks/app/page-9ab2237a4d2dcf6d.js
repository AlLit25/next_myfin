(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{267:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var r=s(5155),n=s(2115),a=s(4964),c=s(5576),l=s(2378),i=s(2253);function o(){let[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)(""),[o,u]=(0,n.useState)(null),d=async t=>{t.preventDefault(),u(null);try{let{data:t,error:r}=await c.DB.auth.signInWithPassword({email:e,password:s});if(r)return void u(r.message);l.A.set("supabase-auth-token",JSON.stringify(t.session),{expires:1,path:"/",secure:!0,sameSite:"Strict"}),location.reload()}catch(e){u("Помилка авторизації: "+e.message)}};return(0,r.jsx)("div",{className:"d-block",children:(0,r.jsxs)("form",{onSubmit:d,children:[o&&(0,r.jsx)("div",{className:"alert alert-danger",children:o}),(0,r.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,r.jsxs)("div",{className:i.Fr?"w-100":"w-50",children:[(0,r.jsx)("label",{className:"form-label",children:"Email"}),(0,r.jsx)("input",{className:"form-control form-control-lg",type:"email",placeholder:"email@com.ua",value:e,onChange:e=>t(e.target.value),required:!0})]})}),(0,r.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,r.jsxs)("div",{className:i.Fr?"w-100":"w-50",children:[(0,r.jsx)("label",{className:"form-label",children:"Пароль"}),(0,r.jsx)("input",{className:"form-control form-control-lg",type:"password",placeholder:"",value:s,onChange:e=>a(e.target.value),required:!0})]})}),(0,r.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,r.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Увійти"})})]})})}var u=s(4091);s(2906),s(4680);var d=s(2619),h=s.n(d);function m(){let[e,t]=(0,n.useState)(0),[s,c]=(0,n.useState)(!0);function l(){c(!0),(0,a.r1)().then(e=>{t(e.data.uah||0),c(!1)}).catch(e=>{c(!1)})}return(0,n.useEffect)(()=>{l()},[]),(0,r.jsx)("div",{children:s?(0,r.jsx)(u.A,{header:!1}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-9",children:(0,r.jsxs)("h2",{children:["Баланс ",e," UAH"]})}),(0,r.jsxs)("div",{className:"col-3 pt-2 text-end",children:[(0,r.jsx)("span",{onClick:l,"data-refresh":"balance",className:"refresh-icon",children:(0,r.jsx)("svg",{id:"Layer_1",version:"1.1",viewBox:"0 0 32 32",width:"20px",height:"20px",xmlSpace:"preserve",children:(0,r.jsx)("path",{fill:"currentColor",d:"M28,16c-1.219,0-1.797,0.859-2,1.766C25.269,21.03,22.167,26,16,26c-5.523,0-10-4.478-10-10S10.477,6,16,6  c2.24,0,4.295,0.753,5.96,2H20c-1.104,0-2,0.896-2,2s0.896,2,2,2h6c1.104,0,2-0.896,2-2V4c0-1.104-0.896-2-2-2s-2,0.896-2,2v0.518  C21.733,2.932,18.977,2,16,2C8.268,2,2,8.268,2,16s6.268,14,14,14c9.979,0,14-9.5,14-11.875C30,16.672,28.938,16,28,16z"})})}),(0,r.jsx)(h(),{href:"/balance",className:"next-btn-inline",children:(0,r.jsx)("svg",{className:"feather feather-chevron-right",fill:"none",height:"24",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("polyline",{points:"9 18 15 12 9 6"})})})]})]})})})}var x=s(9582);function f(){let[e,t]=(0,n.useState)({income:[],expense:[]}),s=(0,x._B)(),[l,i]=(0,n.useState)(!0),o=0,d=0,m=async(e,s)=>{try{let r=await (0,a.h5)(e,s);if(r.error)t({income:[],expense:[]});else{let e={income:[],expense:[]};(r.data||[]).forEach(t=>{"expense"===t.type?e.expense.push(t):"income"===t.type&&e.income.push(t)}),t(e)}i(!1)}catch(e){i(!1)}};function f(){i(!0),m(s.from,s.to)}return(0,n.useEffect)(()=>{f()},[]),(0,r.jsx)("div",{children:l?(0,r.jsx)(u.A,{header:!1}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-6",children:(0,r.jsx)("h3",{children:(0,x.At)(new Date,"full")})}),(0,r.jsxs)("div",{className:"col-6 text-end",children:[(0,r.jsx)("span",{onClick:f,"data-refresh":"statistic",className:"refresh-icon",children:(0,r.jsx)("svg",{id:"Layer_1",version:"1.1",viewBox:"0 0 32 32",width:"20px",height:"20px",xmlSpace:"preserve",children:(0,r.jsx)("path",{fill:"currentColor",d:"M28,16c-1.219,0-1.797,0.859-2,1.766C25.269,21.03,22.167,26,16,26c-5.523,0-10-4.478-10-10S10.477,6,16,6  c2.24,0,4.295,0.753,5.96,2H20c-1.104,0-2,0.896-2,2s0.896,2,2,2h6c1.104,0,2-0.896,2-2V4c0-1.104-0.896-2-2-2s-2,0.896-2,2v0.518  C21.733,2.932,18.977,2,16,2C8.268,2,2,8.268,2,16s6.268,14,14,14c9.979,0,14-9.5,14-11.875C30,16.672,28.938,16,28,16z"})})}),(0,r.jsx)(h(),{href:"/statistic",className:"next-btn-inline",children:(0,r.jsx)("svg",{className:"feather feather-chevron-right",fill:"none",height:"24",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("polyline",{points:"9 18 15 12 9 6"})})})]})]}),(0,r.jsxs)("div",{children:["Дохід: ",e.income.length>0?(0,r.jsxs)("ul",{children:[e.income.map(e=>(o+=e.sum,(0,r.jsxs)("li",{children:[e.sum," UAH"]},e.id)))," ",e.income.length>1?(0,r.jsxs)("li",{children:[(0,r.jsx)("b",{children:"Загалом:"})," ",o," UAH"]}):""]}):"відсутній"]}),(0,r.jsxs)("div",{children:["Витрати: ",e.expense.length>0?(0,r.jsxs)("ul",{children:[e.expense.map(e=>(d+=e.sum,(0,r.jsxs)("li",{children:[e.sum," UAH (",c.L1[e.category],")"]},e.id))),e.expense.length>0?(0,r.jsxs)("li",{children:[(0,r.jsx)("b",{children:"Загалом:"})," ",d," UAH"]}):""]}):"відсутні"]})]})})}var j=s(907);function v(e){let{setTextNotify:t,setShowNotify:s}=e,[c,l]=(0,n.useState)(""),[i,o]=(0,n.useState)(!1);return(0,r.jsx)("div",{children:i?(0,r.jsx)(u.A,{header:!1}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"mb-2 col-sm-12 d-flex justify-content-center",children:(0,r.jsx)("input",{type:"number",className:"form-control i-default",value:c,placeholder:"сума доходу",onChange:e=>l(e.target.value),min:"0"})}),(0,r.jsx)("div",{className:"col-sm-12 text-center",children:(0,r.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){if(o(!0),Number(c)>0){let e=(0,j.hS)();null===e&&(s(!0),t("Необхідно обрати дату"),o(!1)),(0,a.Ou)(e,c,"income","","").then(e=>{s(!0),e?(l(""),t("Данні додано успішно")):t("Не вдалось додати дані"),o(!1),(0,j.JX)()})}else s(!0),t("Поле сумма не може бути порожнім"),o(!1)},children:"Додати дохід"})})]})})})}function p(e){let{setTextNotify:t,setShowNotify:s}=e,[l,i]=(0,n.useState)(!1),[o,d]=(0,n.useState)(""),[h,m]=(0,n.useState)(""),[f,v]=(0,n.useState)("");return(0,r.jsx)("div",{children:l?(0,r.jsx)(u.A,{header:!1}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,r.jsx)("input",{type:"number",className:"i-default form-control",min:"0",placeholder:"сума витрати",value:h,onChange:e=>m(e.target.value)})}),(0,r.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,r.jsxs)("select",{className:"form-control s-default",value:o,onChange:e=>d(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Обрати"},""),Object.entries(c.L1).map(e=>{let[t,s]=e;return(0,r.jsx)("option",{value:t,children:s},t)})]})}),(0,r.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,r.jsx)("textarea",{className:"form-control t-default",onChange:e=>v(e.target.value),value:f})}),(0,r.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,r.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){if(i(!0),Number(h)>0&&o.length>0){let e=(0,x._B)();(0,a.Ou)(e.from,h,"expense",o,f).then(e=>{s(!0),e?(m(""),v(""),t("Данні додано успішно")):t("Не вдалось додати дані"),i(!1),(0,j.JX)()})}else s(!0),t("Поле категорія та сумма не можуть бути порожніми"),i(!1)},children:"Додати витрату"})})]})})}var N=s(7866);function g(){let[e,t]=(0,n.useState)(0),[s,a]=(0,n.useState)(!1),[c,l]=(0,n.useState)(""),i=(0,n.useRef)(null),o=(0,n.useRef)(0),u=(0,n.useRef)(0),d=(0,n.useRef)(!1),[h,j]=(0,n.useState)((0,x._B)());return(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)(N.A,{show:s,text:c,setShowDefault:a}),(0,r.jsxs)("div",{className:"col-12",children:[(0,r.jsx)("div",{className:"slider-container",children:(0,r.jsxs)("div",{className:"slider-track d-flex",ref:i,style:{transform:"translateX(-".concat(50*e,"%)")},onTouchStart:e=>{o.current=e.touches[0].clientX,u.current=o.current,d.current=!0,i.current&&(i.current.style.transition="none")},onTouchMove:t=>{if(!d.current)return;u.current=t.touches[0].clientX;let s=-(50*e)+(u.current-o.current)/window.innerWidth*100;i.current&&(i.current.style.transform="translateX(".concat(s,"%)"))},onTouchEnd:()=>{if(!d.current)return;d.current=!1,i.current&&(i.current.style.transition="transform 0.3s ease-in-out");let s=u.current-o.current,r=e;Math.abs(s)>50&&(s>0&&e>0?r=e-1:s<0&&e<1&&(r=e+1)),t(r),i.current&&(i.current.style.transform="translateX(-".concat(50*r,"%)"))},children:[(0,r.jsxs)("div",{className:"slide p-3",children:[(0,r.jsx)("div",{className:"d-block-desk",style:{width:"100%"},children:(0,r.jsx)(m,{})}),(0,r.jsx)("div",{className:"d-block-desk mt-3",style:{width:"100%"},children:(0,r.jsx)(f,{})})]}),(0,r.jsxs)("div",{className:"slide p-3",children:[(0,r.jsx)("div",{className:"d-block-desk",children:(0,r.jsx)("input",{type:"date",className:"form-control","data-date":"mainPage",value:h.from,onChange:e=>j({...h,from:e.target.value})})}),(0,r.jsx)("div",{className:"d-block-desk mt-3",style:{width:"100%"},children:(0,r.jsx)(v,{setTextNotify:l,setShowNotify:a})}),(0,r.jsx)("div",{className:"d-block-desk mt-3",style:{width:"100%"},children:(0,r.jsx)(p,{setTextNotify:l,setShowNotify:a})})]})]})}),(0,r.jsx)("div",{className:"dots",children:[0,1].map(s=>(0,r.jsx)("span",{className:"dot ".concat(e===s?"active":""),onClick:()=>t(s)},s))})]})]})}function w(){let[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)(""),[c,l]=(0,n.useState)((0,x._B)()),i=new Date().toISOString().split("T")[0];return(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)(N.A,{show:e,text:s,setShowDefault:t}),(0,r.jsxs)("div",{className:"col-6",children:[(0,r.jsx)("div",{className:"d-block-desk",children:(0,r.jsx)(m,{})}),(0,r.jsx)("div",{className:"d-block-desk mt-2",children:(0,r.jsx)(f,{})})]}),(0,r.jsxs)("div",{className:"col-6",children:[(0,r.jsx)("div",{className:"d-block-desk d-flex justify-content-center",children:(0,r.jsx)("input",{type:"date",className:"form-control i-default","data-date":"mainPage",value:c.from,max:i,onChange:e=>l({...c,from:e.target.value})})}),(0,r.jsx)("div",{className:"d-block-desk mt-2",children:(0,r.jsx)(v,{setTextNotify:a,setShowNotify:t})}),(0,r.jsx)("div",{className:"d-block-desk mt-2",children:(0,r.jsx)(p,{setTextNotify:a,setShowNotify:t})})]})]})}function y(){return(0,r.jsx)("div",{children:i.Fr?(0,r.jsx)(g,{}):(0,r.jsx)(w,{})})}function b(){let[e,t]=(0,n.useState)(!1),[s,c]=(0,n.useState)(!0);return((0,n.useEffect)(()=>{!async function(){try{await (0,a.T5)()?t(!0):((0,a.e4)(),t(!1)),c(!1)}catch(e){(0,a.e4)(),t(!1),c(!1)}}()},[]),s)?(0,r.jsx)(u.A,{}):(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)("div",{className:"m-5 text-center",children:(0,r.jsx)("p",{className:"h1",children:"LiVi Analytics"})}),e?(0,r.jsx)(y,{}):(0,r.jsx)(o,{})]})}},907:(e,t,s)=>{"use strict";s.d(t,{E6:()=>i,JX:()=>h,ac:()=>l,b8:()=>o,cI:()=>u,hS:()=>d,nS:()=>c,w8:()=>n,zl:()=>a});var r=s(5576);function n(e){let t=0;return e.map(e=>{t+=e.sum}),t}function a(e){return e.reduce((e,t)=>{let s=t.created_at,r=t.category,n=t.sum;return e[s]||(e[s]={}),e[s][r]=(e[s][r]||0)+n,e},{})}function c(e){let t={};return Object.keys(e).map(s=>{Object.keys(e[s]).map(r=>{void 0===t[r]?t[r]=Number(e[s][r]):t[r]+=Number(e[s][r])})}),t}function l(e,t){let s=[],r=new Date(e),n=new Date(t);for(;r<=n;)s.push(r.toISOString().split("T")[0]),r.setDate(r.getDate()+1);return s}function i(e,t){let s=[];return Object.keys(t).map(n=>{s.push({name:r.L1[n],value:t[n],percentage:(t[n]/e*100).toFixed(1)})}),s}function o(e){return Object.keys(e).sort((e,t)=>new Date(e)-new Date(t))}function u(e,t){let s=[];return e.map(e=>{e.created_at===t&&s.push(e)}),s}function d(){let e=document.querySelector('input[data-date="mainPage"]');return void 0!==e?e.value:null}function h(){let e=document.querySelector('span[data-refresh="balance"]'),t=document.querySelector('span[data-refresh="statistic"]');void 0!==e&&e.click(),void 0!==t&&t.click()}},2906:()=>{},2979:(e,t,s)=>{Promise.resolve().then(s.bind(s,267))},4091:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(5155);function n(e){let{header:t=!0}=e;return(0,r.jsxs)("div",{className:"container",children:[t?(0,r.jsx)("div",{className:"m-5 text-center",children:(0,r.jsx)("p",{className:"h1",children:"LiVi Analytics"})}):"",(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"spinner-border text-success",role:"status",children:(0,r.jsx)("span",{className:"visually-hidden"})}),(0,r.jsx)("h3",{children:"Завантаження..."})]})]})}},4680:()=>{},4964:(e,t,s)=>{"use strict";s.d(t,{Ou:()=>u,T5:()=>c,Wv:()=>f,e4:()=>i,h5:()=>o,m8:()=>d,pt:()=>l,r1:()=>x,uo:()=>m});var r=s(2378),n=s(5576);function a(){let e=r.A.get("supabase-auth-token");return e||null}async function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{let s,c=a();try{if(null===c||(s=JSON.parse(c),null===s))return null;{if(!s.access_token||!s.refresh_token)return await goToLogin(e),null;let{data:{session:a},error:c}=await n.DB.auth.setSession({access_token:s.access_token,refresh_token:s.refresh_token});if(!c)return a;{var t;let{data:e,error:a}=await n.DB.auth.refreshSession({refresh_token:s.refresh_token});if(a)return null;return t=e.session,r.A.set("supabase-auth-token",JSON.stringify(t),{expires:1,path:"/",secure:!0,sameSite:"Strict"}),e.session}}}catch(e){return null}}catch(e){return console.error("Помилка перевірки автентифікації:",e.message,e.stack),null}}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(e||window.location.pathname).startsWith("/next_myfin")?"/next_myfin/":"/"}function i(){r.A.remove("supabase-auth-token",{path:"/"})}async function o(e,t){let s={data:null,error:""};try{if(!await c())return s.error="Користувач не авторизований",s;let{data:r,error:a}=await n.DB.from(n.Bt.main).select("*").gte("created_at",e).lte("created_at",t);if(a)return s.error="Помилка отримання даних із ".concat(n.Bt.main,": ")+a.message,s;s.data=r}catch(e){s.error="Виняток у getStatistic: "+e.message}return s}async function u(e,t,s,r,l){try{if(!await c())throw"Користувач не авторизований";let i=JSON.parse(a()),o={sum:t,type:s,user_id:i.user.id,created_at:new Date(e),category:r||null,comment:l||null},{error:u}=await n.DB.from(n.Bt.main).insert([o]);if(u)throw u;return await h(t,s),!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function d(e,t){try{if(!await c())throw"Користувач не авторизований";let s=JSON.parse(a()),r={sum:t,user_id:s.user.id},{error:l}=await n.DB.from(n.Bt.main).update(r).eq("id",e);if(l)throw l;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function h(e,t){let s=await x(),r=0;s.data.id>0&&(r="expense"===t?s.data.uah-Number(e):s.data.uah+Number(e),await m(s.data.id,r))}async function m(e,t){try{if(!await c())throw"Користувач не авторизований";let s=JSON.parse(a()),r={uah:t,user_id:s.user.id,last_check:new Date},{error:l}=await n.DB.from(n.Bt.balance).update(r).eq("id",e);if(l)throw l;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function x(){let e={data:null,error:""};try{if(!await c())return e.error="Користувач не авторизований",e;let t=JSON.parse(a()),{data:s,error:r}=await n.DB.from(n.Bt.balance).select("*").eq("user_id",t.user.id).single();if(r)return e.error="Помилка отримання даних із ".concat(n.Bt.balance,": ")+r.message,e;e.data=s}catch(t){e.error="Виняток у getBalance: "+t.message}return e}async function f(e){try{if(!await c())throw Error("Користувач не авторизований");let t=JSON.parse(a()),{error:s}=await n.DB.from(n.Bt.main).delete().eq("id",e).eq("user_id",t.user.id);if(s)return!1;return!0}catch(e){return!1}}s(87)},5576:(e,t,s)=>{"use strict";s.d(t,{Bt:()=>n,DB:()=>r,L1:()=>a});let r=(0,s(2659).UU)("https://vntunuzrneoakdckqjvk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZudHVudXpybmVvYWtkY2txanZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTI5NzEsImV4cCI6MjA2NzI4ODk3MX0.CWJIVqq-x5_doDk8rsl8ZJWP7um9VakuIDBihcfsrsU"),n={main:"fin_statistic",balance:"fin_balance"},a={pr:"Продукти",cf:"Кафе",cm:"Кумунальні платежі",md:"Аптека",eva:"Eva/Makeup",zoo:"Зоотовари",cl:"Одяг",usd:"Валюта",ot:"Інше"}},7866:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(5155),n=s(2115);function a(e){let{show:t,text:s,setShowDefault:a}=e;return((0,n.useEffect)(()=>{if(t){let e=setTimeout(()=>{a(!1)},2e3);return()=>clearTimeout(e)}},[t]),t||0!==s.length)?(0,r.jsx)("div",{className:"c-modal ".concat(t?"fade-in":"fade-out"),id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,r.jsx)("div",{className:"modal-dialog text-center",children:(0,r.jsx)("div",{className:"alert alert-primary pt-3",role:"alert",children:s})})}):null}},9582:(e,t,s)=>{"use strict";function r(){let e=new Date,t=new Date(e);return t.setDate(e.getDate()+1),{from:a(e),to:a(t)}}function n(){let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),s=new Date(e.getFullYear(),e.getMonth()+1,0);return{from:a(t),to:a(s)}}function a(e){let t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(r)}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",s=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),a=e.getDay(),c="";return"short"===t?c=["Нд","Пн","Вт","Ср","Чт","Пт","Сб"][a]+", ":"full"===t&&(c=["Неділя","Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота"][a]+", "),c+"".concat(n,".").concat(r,".").concat(s)}s.d(t,{At:()=>c,Ew:()=>n,_B:()=>r})}},e=>{e.O(0,[975,813,253,441,255,358],()=>e(e.s=2979)),_N_E=e.O()}]);