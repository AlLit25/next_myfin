(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2093:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(5155),a=s(2115),n=s(4964),c=s(7260),i=s(5576),l=s(2378);function o(){let[e,t]=(0,a.useState)(""),[s,n]=(0,a.useState)(""),[o,u]=(0,a.useState)(null);(0,c.useRouter)();let d=async t=>{t.preventDefault(),u(null);try{let{data:t,error:r}=await i.DB.auth.signInWithPassword({email:e,password:s});if(r)return void u(r.message);l.A.set("supabase-auth-token",JSON.stringify(t.session),{expires:1,path:"/",secure:!0,sameSite:"Strict"}),location.reload()}catch(e){u("Помилка авторизації: "+e.message)}};return(0,r.jsx)("div",{className:"d-block",children:(0,r.jsxs)("form",{onSubmit:d,children:[o&&(0,r.jsx)("div",{className:"alert alert-danger",children:o}),(0,r.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,r.jsxs)("div",{className:"w-50",children:[(0,r.jsx)("label",{className:"form-label",children:"Email"}),(0,r.jsx)("input",{className:"form-control form-control-lg",type:"email",placeholder:"email@com.ua",value:e,onChange:e=>t(e.target.value),required:!0})]})}),(0,r.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,r.jsxs)("div",{className:"w-50",children:[(0,r.jsx)("label",{className:"form-label",children:"Пароль"}),(0,r.jsx)("input",{className:"form-control form-control-lg",type:"password",placeholder:"",value:s,onChange:e=>n(e.target.value),required:!0})]})}),(0,r.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,r.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Увійти"})})]})})}var u=s(8148);function d(){return(0,r.jsxs)("div",{className:"d-block",children:[(0,r.jsx)(u.A,{href:"/income",color:"primary",text:"Дохід"}),(0,r.jsx)(u.A,{href:"/expense",color:"primary",text:"Витрати"}),(0,r.jsx)(u.A,{href:"/statistic",color:"primary",text:"Статистика"}),(0,r.jsx)(u.A,{href:"/balance",color:"primary",text:"Баланс"})]})}var h=s(4091);function m(){let[e,t]=(0,a.useState)(!1),[s,c]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{!async function(){try{await (0,n.T5)()?t(!0):((0,n.e4)(),t(!1)),c(!1)}catch(e){(0,n.e4)(),t(!1),c(!1)}}()},[]),console.log("Рендеринг Home:","isLoading:",s,"isAuthenticated:",e),s)?(0,r.jsx)(h.A,{}):(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)("div",{className:"m-5 text-center",children:(0,r.jsx)("p",{className:"h1",children:"LiVi Analytics"})}),e?(0,r.jsx)(d,{}):(0,r.jsx)(o,{})]})}},2979:(e,t,s)=>{Promise.resolve().then(s.bind(s,2093))},4091:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(5155);function a(){return(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)("div",{className:"m-5 text-center",children:(0,r.jsx)("p",{className:"h1",children:"LiVi Analytics"})}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"spinner-border text-success",role:"status",children:(0,r.jsx)("span",{className:"visually-hidden"})}),(0,r.jsx)("h3",{children:"Завантаження..."})]})]})}},4964:(e,t,s)=>{"use strict";s.d(t,{T5:()=>n,e4:()=>c,h5:()=>i});var r=s(2378),a=s(5576);async function n(){try{let t,s=function(){let e=r.A.get("supabase-auth-token");return e||null}();try{t=JSON.parse(s)}catch(e){return!1}if(!t.access_token||!t.refresh_token)return!1;let{data:{session:n},error:c}=await a.DB.auth.setSession({access_token:t.access_token,refresh_token:t.refresh_token});if(!c)return n;{var e;let{data:s,error:c}=await a.DB.auth.refreshSession({refresh_token:t.refresh_token});if(c)return!1;return e=n,r.A.set("supabase-auth-token",JSON.stringify(e),{expires:1,path:"/",secure:!0,sameSite:"Strict"}),s.session}}catch(e){return console.error("Помилка перевірки автентифікації:",e.message),!1}}function c(){r.A.remove("supabase-auth-token",{path:"/"})}async function i(e,t){let s={data:null,error:""};try{if(!await n())return s.error="Користувач не авторизований",s;let{data:r,error:c}=await a.DB.from(a.B.main).select("*").gte("created_at",e).lte("created_at",t);if(c)return s.error="Помилка отримання даних із ".concat(table,":"),c.message,s;s.data=r}catch(e){s.error="Виняток у fetchData: "+e.message}return s}},5576:(e,t,s)=>{"use strict";s.d(t,{B:()=>a,DB:()=>r});let r=(0,s(2659).UU)("https://vntunuzrneoakdckqjvk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZudHVudXpybmVvYWtkY2txanZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTI5NzEsImV4cCI6MjA2NzI4ODk3MX0.CWJIVqq-x5_doDk8rsl8ZJWP7um9VakuIDBihcfsrsU"),a={main:"fin_statistic",balance:"fin_balance"}},8148:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var r=s(5155),a=s(2619),n=s.n(a);function c(e){let{href:t,text:s,color:a}=e;return(0,r.jsx)("div",{className:"text-center p-2",children:(0,r.jsx)(n(),{href:t,className:"btn btn-".concat(a," btn-menu fs-4 fw-bold"),children:s})})}}},e=>{e.O(0,[619,263,441,255,358],()=>e(e.s=2979)),_N_E=e.O()}]);