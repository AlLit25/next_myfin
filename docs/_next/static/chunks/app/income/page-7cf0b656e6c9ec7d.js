(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[340],{4964:(e,t,a)=>{"use strict";a.d(t,{Ou:()=>d,T5:()=>i,Wv:()=>g,e4:()=>u,h5:()=>l,m8:()=>f,pt:()=>o,r1:()=>p,uo:()=>h});var r=a(2378),n=a(5576);function s(){let e=r.A.get("supabase-auth-token");return e||null}async function i(){try{let t,a=s();try{if(t=JSON.parse(a),null!==t){t.access_token&&t.refresh_token||c();let{data:{session:a},error:s}=await n.DB.auth.setSession({access_token:t.access_token,refresh_token:t.refresh_token});if(!s)return a;{var e;let{data:s,error:i}=await n.DB.auth.refreshSession({refresh_token:t.refresh_token});return i?c():(e=a,r.A.set("supabase-auth-token",JSON.stringify(e),{expires:1,path:"/",secure:!0,sameSite:"Strict"})),s.session}}c()}catch(e){c()}}catch(e){console.error("Помилка перевірки автентифікації:",e.message,e.line),c()}}function c(){let e=location.pathname,t=o();e!==t&&(location.href=t)}function o(){return location.pathname.startsWith("/next_myfin")?"/next_myfin/":"/"}function u(){r.A.remove("supabase-auth-token",{path:"/"})}async function l(e,t){let a={data:null,error:""};try{if(!await i())return a.error="Користувач не авторизований",a;let{data:r,error:s}=await n.DB.from(n.Bt.main).select("*").gte("created_at",e).lte("created_at",t);if(s)return a.error="Помилка отримання даних із ".concat(n.Bt.main,": ")+s.message,a;a.data=r}catch(e){a.error="Виняток у getStatistic: "+e.message}return a}async function d(e,t,a,r,c){try{if(!await i())throw"Користувач не авторизований";let o=JSON.parse(s()),u={sum:t,type:a,user_id:o.user.id,created_at:new Date(e),category:r||null,comment:c||null},{error:l}=await n.DB.from(n.Bt.main).insert([u]);if(l)throw l;return await m(t,a),!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function f(e,t){try{if(!await i())throw"Користувач не авторизований";let a=JSON.parse(s()),r={sum:t,user_id:a.user.id},{error:c}=await n.DB.from(n.Bt.main).update(r).eq("id",e);if(c)throw c;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function m(e,t){let a=await p(),r=0;a.data.id>0&&(r="expense"===t?a.data.uah-Number(e):a.data.uah+Number(e),await h(a.data.id,r))}async function h(e,t){try{if(!await i())throw"Користувач не авторизований";let a=JSON.parse(s()),r={uah:t,user_id:a.user.id,last_check:new Date},{error:c}=await n.DB.from(n.Bt.balance).update(r).eq("id",e);if(c)throw c;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function p(){let e={data:null,error:""};try{if(!await i())return e.error="Користувач не авторизований",e;let t=JSON.parse(s()),{data:a,error:r}=await n.DB.from(n.Bt.balance).select("*").eq("user_id",t.user.id).single();if(r)return e.error="Помилка отримання даних із ".concat(n.Bt.balance,": ")+r.message,e;e.data=a}catch(t){e.error="Виняток у getBalance: "+t.message}return e}async function g(e){try{if(!await i())throw Error("Користувач не авторизований");let t=JSON.parse(s()),{error:a}=await n.DB.from(n.Bt.main).delete().eq("id",e).eq("user_id",t.user.id);if(a)return!1;return!0}catch(e){return!1}}},5029:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(5155),n=a(8148),s=a(2115),i=a(9582),c=a(4964),o=a(7866);function u(){let[e,t]=(0,s.useState)((0,i._B)()),[a,u]=(0,s.useState)(""),[l,d]=(0,s.useState)(!1),[f,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)("");return(0,r.jsxs)("div",{children:[(0,r.jsx)(o.A,{show:f,text:h,setShowDefault:m}),(0,r.jsx)("div",{className:"mt-3 text-center",children:(0,r.jsx)("h1",{children:"Дохід"})}),(0,r.jsx)("div",{className:"d-block",children:(0,r.jsx)(n.A,{href:"/",color:"secondary",text:"На головну"})}),(0,r.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,r.jsx)("input",{type:"date",className:"i-default form-control",value:e.from,onChange:a=>t({...e,from:a.target.value})})}),(0,r.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,r.jsx)("input",{type:"number",className:"i-default form-control",value:a,onChange:e=>u(e.target.value),min:"0"})}),(0,r.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,r.jsx)("button",{type:"button",className:"btn btn-success b-default",disabled:l,onClick:function(){d(!0),Number(a)>0?(0,c.Ou)(e.from,a,"income","","").then(e=>{m(!0),e?(u(""),p("Данні додано успішно")):p("Не вдалось додати дані"),d(!1)}):(m(!0),p("Поле сумма не може бути порожнім"),d(!1))},children:"Додати"})})]})}},5576:(e,t,a)=>{"use strict";a.d(t,{Bt:()=>n,DB:()=>r,L1:()=>s});let r=(0,a(2659).UU)("https://vntunuzrneoakdckqjvk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZudHVudXpybmVvYWtkY2txanZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTI5NzEsImV4cCI6MjA2NzI4ODk3MX0.CWJIVqq-x5_doDk8rsl8ZJWP7um9VakuIDBihcfsrsU"),n={main:"fin_statistic",balance:"fin_balance"},s={pr:"Продукти",cf:"Кафе",cm:"Кумунальні платежі",md:"Аптека",eva:"Eva/Makeup",zoo:"Зоотовари",cl:"Одяг",usd:"Валюта",ot:"Інше"}},6109:(e,t,a)=>{Promise.resolve().then(a.bind(a,5029))},7866:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(5155),n=a(2115);function s(e){let{show:t,text:a,setShowDefault:s}=e;return((0,n.useEffect)(()=>{if(t){let e=setTimeout(()=>{s(!1)},2e3);return()=>clearTimeout(e)}},[t]),t||0!==a.length)?(0,r.jsx)("div",{className:"c-modal ".concat(t?"fade-in":"fade-out"),id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,r.jsx)("div",{className:"modal-dialog text-center",children:(0,r.jsx)("div",{className:"alert alert-primary pt-3",role:"alert",children:a})})}):null}},8148:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(5155),n=a(2619),s=a.n(n);function i(e){let{href:t,text:a,color:n}=e;return(0,r.jsx)("div",{className:"text-center p-2",children:(0,r.jsx)(s(),{href:t,className:"btn btn-".concat(n," btn-menu fs-4 fw-bold"),children:a})})}},9582:(e,t,a)=>{"use strict";function r(){let e=new Date,t=new Date(e);return t.setDate(e.getDate()+1),{from:s(e),to:s(t)}}function n(){let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),a=new Date(e.getFullYear(),e.getMonth()+1,0);return{from:s(t),to:s(a)}}function s(e){let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(r)}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",a=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),s=e.getDay(),i="";return"short"===t?i=["Нд","Пн","Вт","Ср","Чт","Пт","Сб"][s]+", ":"full"===t&&(i=["Неділя","Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота"][s]+", "),i+"".concat(n,".").concat(r,".").concat(a)}a.d(t,{At:()=>i,Ew:()=>n,_B:()=>r})}},e=>{e.O(0,[263,619,441,255,358],()=>e(e.s=6109)),_N_E=e.O()}]);