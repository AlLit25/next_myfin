(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{907:(e,t,r)=>{"use strict";r.d(t,{E6:()=>l,PD:()=>d,ac:()=>i,b8:()=>o,cI:()=>u,nS:()=>c,w8:()=>a,zl:()=>n});var s=r(5576);function a(e){let t=0;return e.map(e=>{t+=e.sum}),t}function n(e){return e.reduce((e,t)=>{let r=t.created_at,s=t.category,a=t.sum;return e[r]||(e[r]={}),e[r][s]=(e[r][s]||0)+a,e},{})}function c(e){let t={};return Object.keys(e).map(r=>{Object.keys(e[r]).map(s=>{void 0===t[s]?t[s]=Number(e[r][s]):t[s]+=Number(e[r][s])})}),t}function i(e,t){let r=[],s=new Date(e),a=new Date(t);for(;s<=a;)r.push(s.toISOString().split("T")[0]),s.setDate(s.getDate()+1);return r}function l(e,t){let r=[];return Object.keys(t).map(a=>{r.push({name:s.L1[a],value:t[a],percentage:(t[a]/e*100).toFixed(1)})}),r}function o(e){return Object.keys(e).sort((e,t)=>new Date(e)-new Date(t))}function u(e,t){let r=[];return e.map(e=>{e.created_at===t&&r.push(e)}),r}function d(){let e=document.querySelector('button[data-refresh="statistic"]');void 0!==e&&e.click()}},1559:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(5155),a=r(2115),n=r(9582),c=r(4964),i=r(4091),l=r(5576);function o(){let[e,t]=(0,a.useState)({income:[],expense:[]}),r=(0,n._B)(),[o,u]=(0,a.useState)(!0),d=async(e,r)=>{try{let s=await (0,c.h5)(e,r);if(s.error)t({income:[],expense:[]});else{let e={income:[],expense:[]};(s.data||[]).forEach(t=>{"expense"===t.type?e.expense.push(t):"income"===t.type&&e.income.push(t)}),t(e)}u(!1)}catch(e){location.reload()}};function h(){u(!0),d(r.from,r.to)}return(0,a.useEffect)(()=>{h()},[]),(0,s.jsx)("div",{children:o?(0,s.jsx)(i.A,{header:!1}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-6",children:(0,s.jsx)("h3",{children:(0,n.At)(new Date,"full")})}),(0,s.jsxs)("div",{className:"col-6 text-end",children:[(0,s.jsx)("button",{className:"btn btn-link",onClick:h,"data-refresh":"statistic",children:"Оновити"}),(0,s.jsx)("a",{className:"btn btn-link",href:"/statistic",children:"Детально"})]})]}),(0,s.jsxs)("div",{children:["Дохід: ",e.income.length>0?(0,s.jsx)("ul",{children:e.income.map(e=>(0,s.jsxs)("li",{children:[e.sum," UAH"]},e.id))}):"відсутній"]}),(0,s.jsxs)("div",{children:["Витрати: ",e.expense.length>0?(0,s.jsx)("ul",{children:e.expense.map(e=>(0,s.jsxs)("li",{children:[e.sum," UAH (",l.L1[e.category],")"]},e.id))}):"відсутні"]}),(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-end"})})]})})}},1783:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(5155),a=r(2115),n=r(4964),c=r(4091);function i(){let[e,t]=(0,a.useState)(0),[r,i]=(0,a.useState)(!0);return(0,n.r1)().then(e=>{t(e.data.uah||0),i(!1)}),(0,s.jsx)("div",{children:r?(0,s.jsx)(c.A,{header:!1}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("h2",{className:"col-8",children:["Баланс ",e," UAH"]}),(0,s.jsx)("a",{className:"col-4 text-end",href:"/balance",children:"Звірити"})]})})})}},2177:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var s=r(5155);r(2802);var a=r(1783),n=r(1559),c=r(9399),i=r(2944),l=r(7866),o=r(2115);function u(){let[e,t]=(0,o.useState)(!1),[r,u]=(0,o.useState)("");return(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)(l.A,{show:e,text:r,setShowDefault:t}),(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("div",{className:"d-block-desk",children:(0,s.jsx)(a.A,{})}),(0,s.jsx)("div",{className:"d-block-desk mt-2",children:(0,s.jsx)(n.A,{})})]}),(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("div",{className:"d-block-desk mt-2",children:(0,s.jsx)(c.A,{setTextNotify:u,setShowNotify:t})}),(0,s.jsx)("div",{className:"d-block-desk mt-2",children:(0,s.jsx)(i.A,{setTextNotify:u,setShowNotify:t})})]})]})}},2802:()=>{},2944:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var s=r(5155),a=r(5576),n=r(4091),c=r(2115),i=r(4964),l=r(9582),o=r(907);function u(e){let{setTextNotify:t,setShowNotify:r}=e,[u,d]=(0,c.useState)(!1),[h,m]=(0,c.useState)(""),[f,x]=(0,c.useState)(""),[j,v]=(0,c.useState)("");return(0,s.jsx)("div",{children:u?(0,s.jsx)(n.A,{header:!1}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,s.jsx)("input",{type:"number",className:"i-default form-control",min:"0",placeholder:"сума витрати",value:f,onChange:e=>x(e.target.value)})}),(0,s.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,s.jsxs)("select",{className:"form-control s-default",value:h,onChange:e=>m(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Обрати"},""),Object.entries(a.L1).map(e=>{let[t,r]=e;return(0,s.jsx)("option",{value:t,children:r},t)})]})}),(0,s.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,s.jsx)("textarea",{className:"form-control t-default",onChange:e=>v(e.target.value),value:j})}),(0,s.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,s.jsx)("button",{type:"button",className:"btn btn-success b-default",onClick:function(){if(d(!0),Number(f)>0&&h.length>0){let e=(0,l._B)();(0,i.Ou)(e.from,f,"expense",h,j).then(e=>{r(!0),e?(x(""),v(""),t("Данні додано успішно")):t("Не вдалось додати дані"),d(!1),(0,o.PD)()})}else r(!0),t("Поле категорія та сумма не можуть бути порожніми"),d(!1)},children:"Додати витрату"})})]})})}},4091:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(5155);function a(e){let{header:t=!0}=e;return(0,s.jsxs)("div",{className:"container",children:[t?(0,s.jsx)("div",{className:"m-5 text-center",children:(0,s.jsx)("p",{className:"h1",children:"LiVi Analytics"})}):"",(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"spinner-border text-success",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden"})}),(0,s.jsx)("h3",{children:"Завантаження..."})]})]})}},4680:()=>{},4964:(e,t,r)=>{"use strict";r.d(t,{Ou:()=>d,T5:()=>c,Wv:()=>j,e4:()=>o,h5:()=>u,m8:()=>h,pt:()=>l,r1:()=>x,uo:()=>f});var s=r(2378),a=r(5576);function n(){let e=s.A.get("supabase-auth-token");return e||null}async function c(){try{let t,r=n();try{if(t=JSON.parse(r),null!==t){t.access_token&&t.refresh_token||i();let{data:{session:r},error:n}=await a.DB.auth.setSession({access_token:t.access_token,refresh_token:t.refresh_token});if(!n)return r;{var e;let{data:n,error:c}=await a.DB.auth.refreshSession({refresh_token:t.refresh_token});return c?i():(e=r,s.A.set("supabase-auth-token",JSON.stringify(e),{expires:1,path:"/",secure:!0,sameSite:"Strict"})),n.session}}i()}catch(e){i()}}catch(e){console.error("Помилка перевірки автентифікації:",e.message,e.line),i()}}function i(){let e=location.pathname,t=l();e!==t&&(location.href=t)}function l(){return location.pathname.startsWith("/next_myfin")?"/next_myfin/":"/"}function o(){s.A.remove("supabase-auth-token",{path:"/"})}async function u(e,t){let r={data:null,error:""};try{if(!await c())return r.error="Користувач не авторизований",r;let{data:s,error:n}=await a.DB.from(a.Bt.main).select("*").gte("created_at",e).lte("created_at",t);if(n)return r.error="Помилка отримання даних із ".concat(a.Bt.main,": ")+n.message,r;r.data=s}catch(e){r.error="Виняток у getStatistic: "+e.message}return r}async function d(e,t,r,s,i){try{if(!await c())throw"Користувач не авторизований";let l=JSON.parse(n()),o={sum:t,type:r,user_id:l.user.id,created_at:new Date(e),category:s||null,comment:i||null},{error:u}=await a.DB.from(a.Bt.main).insert([o]);if(u)throw u;return await m(t,r),!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function h(e,t){try{if(!await c())throw"Користувач не авторизований";let r=JSON.parse(n()),s={sum:t,user_id:r.user.id},{error:i}=await a.DB.from(a.Bt.main).update(s).eq("id",e);if(i)throw i;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function m(e,t){let r=await x(),s=0;r.data.id>0&&(s="expense"===t?r.data.uah-Number(e):r.data.uah+Number(e),await f(r.data.id,s))}async function f(e,t){try{if(!await c())throw"Користувач не авторизований";let r=JSON.parse(n()),s={uah:t,user_id:r.user.id,last_check:new Date},{error:i}=await a.DB.from(a.Bt.balance).update(s).eq("id",e);if(i)throw i;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}async function x(){let e={data:null,error:""};try{if(!await c())return e.error="Користувач не авторизований",e;let t=JSON.parse(n()),{data:r,error:s}=await a.DB.from(a.Bt.balance).select("*").eq("user_id",t.user.id).single();if(s)return e.error="Помилка отримання даних із ".concat(a.Bt.balance,": ")+s.message,e;e.data=r}catch(t){e.error="Виняток у getBalance: "+t.message}return e}async function j(e){try{if(!await c())throw Error("Користувач не авторизований");let t=JSON.parse(n()),{error:r}=await a.DB.from(a.Bt.main).delete().eq("id",e).eq("user_id",t.user.id);if(r)return!1;return!0}catch(e){return!1}}},5576:(e,t,r)=>{"use strict";r.d(t,{Bt:()=>a,DB:()=>s,L1:()=>n});let s=(0,r(2659).UU)("https://vntunuzrneoakdckqjvk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZudHVudXpybmVvYWtkY2txanZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTI5NzEsImV4cCI6MjA2NzI4ODk3MX0.CWJIVqq-x5_doDk8rsl8ZJWP7um9VakuIDBihcfsrsU"),a={main:"fin_statistic",balance:"fin_balance"},n={pr:"Продукти",cf:"Кафе",cm:"Кумунальні платежі",md:"Аптека",eva:"Eva/Makeup",zoo:"Зоотовари",cl:"Одяг",usd:"Валюта",ot:"Інше"}},7021:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var s=r(5155);r(2802),r(4680);var a=r(1783),n=r(1559),c=r(9399),i=r(2944),l=r(7866),o=r(2115);function u(){let[e,t]=(0,o.useState)(0),[r,u]=(0,o.useState)(!1),[d,h]=(0,o.useState)(""),m=(0,o.useRef)(null),f=(0,o.useRef)(0),x=(0,o.useRef)(0),j=(0,o.useRef)(!1);return(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)(l.A,{show:r,text:d,setShowDefault:u}),(0,s.jsxs)("div",{className:"col-12",children:[(0,s.jsx)("div",{className:"slider-container",children:(0,s.jsxs)("div",{className:"slider-track d-flex",ref:m,style:{transform:"translateX(-".concat(50*e,"%)")},onTouchStart:e=>{f.current=e.touches[0].clientX,x.current=f.current,j.current=!0,m.current&&(m.current.style.transition="none")},onTouchMove:t=>{if(!j.current)return;x.current=t.touches[0].clientX;let r=-(50*e)+(x.current-f.current)/window.innerWidth*100;m.current&&(m.current.style.transform="translateX(".concat(r,"%)"))},onTouchEnd:()=>{if(!j.current)return;j.current=!1,m.current&&(m.current.style.transition="transform 0.3s ease-in-out");let r=x.current-f.current,s=e;Math.abs(r)>50&&(r>0&&e>0?s=e-1:r<0&&e<1&&(s=e+1)),t(s),m.current&&(m.current.style.transform="translateX(-".concat(50*s,"%)"))},children:[(0,s.jsxs)("div",{className:"slide p-3",children:[(0,s.jsx)("div",{className:"d-block-desk",style:{width:"100%"},children:(0,s.jsx)(a.A,{})}),(0,s.jsx)("div",{className:"d-block-desk mt-3",style:{width:"100%"},children:(0,s.jsx)(n.A,{})})]}),(0,s.jsxs)("div",{className:"slide p-3",children:[(0,s.jsx)("div",{className:"d-block-desk",style:{width:"100%"},children:(0,s.jsx)(c.A,{setTextNotify:h,setShowNotify:u})}),(0,s.jsx)("div",{className:"d-block-desk mt-3",style:{width:"100%"},children:(0,s.jsx)(i.A,{setTextNotify:h,setShowNotify:u})})]})]})}),(0,s.jsx)("div",{className:"dots",children:[0,1].map(r=>(0,s.jsx)("span",{className:"dot ".concat(e===r?"active":""),onClick:()=>t(r)},r))})]})]})}},7866:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(5155),a=r(2115);function n(e){let{show:t,text:r,setShowDefault:n}=e;return((0,a.useEffect)(()=>{if(t){let e=setTimeout(()=>{n(!1)},2e3);return()=>clearTimeout(e)}},[t]),t||0!==r.length)?(0,s.jsx)("div",{className:"c-modal ".concat(t?"fade-in":"fade-out"),id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,s.jsx)("div",{className:"modal-dialog text-center",children:(0,s.jsx)("div",{className:"alert alert-primary pt-3",role:"alert",children:r})})}):null}},9399:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(5155),a=r(4091),n=r(2115),c=r(4964),i=r(9582);r(7866);var l=r(907);function o(e){let{setTextNotify:t,setShowNotify:r}=e,[o,u]=(0,n.useState)(""),[d,h]=(0,n.useState)(!1);return(0,s.jsx)("div",{children:d?(0,s.jsx)(a.A,{header:!1}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-8",children:(0,s.jsx)("input",{type:"number",className:"form-control",value:o,placeholder:"сума доходу",onChange:e=>u(e.target.value),min:"0"})}),(0,s.jsx)("div",{className:"col-4",children:(0,s.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){if(h(!0),Number(o)>0){let e=(0,i._B)();(0,c.Ou)(e.from,o,"income","","").then(e=>{r(!0),e?(u(""),t("Данні додано успішно")):t("Не вдалось додати дані"),h(!1),(0,l.PD)()})}else r(!0),t("Поле сумма не може бути порожнім"),h(!1)},children:"Додати дохід"})})]})})})}},9582:(e,t,r)=>{"use strict";function s(){let e=new Date,t=new Date(e);return t.setDate(e.getDate()+1),{from:n(e),to:n(t)}}function a(){let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),r=new Date(e.getFullYear(),e.getMonth()+1,0);return{from:n(t),to:n(r)}}function n(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(s)}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),n=e.getDay(),c="";return"short"===t?c=["Нд","Пн","Вт","Ср","Чт","Пт","Сб"][n]+", ":"full"===t&&(c=["Неділя","Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота"][n]+", "),c+"".concat(a,".").concat(s,".").concat(r)}r.d(t,{At:()=>c,Ew:()=>a,_B:()=>s})}}]);