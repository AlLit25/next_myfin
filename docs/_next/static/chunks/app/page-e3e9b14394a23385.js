(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2093:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var s=r(5155),n=r(2115),a=r(4964),c=r(7260),i=r(5576),o=r(2378);function l(){let[e,t]=(0,n.useState)(""),[r,a]=(0,n.useState)(""),[l,u]=(0,n.useState)(null);(0,c.useRouter)();let d=async t=>{t.preventDefault(),u(null);try{let{data:t,error:s}=await i.DB.auth.signInWithPassword({email:e,password:r});if(s)return void u(s.message);o.A.set("supabase-auth-token",JSON.stringify(t.session),{expires:1,path:"/",secure:!0,sameSite:"Strict"}),location.reload()}catch(e){u("Помилка авторизації: "+e.message)}};return(0,s.jsx)("div",{className:"d-block",children:(0,s.jsxs)("form",{onSubmit:d,children:[l&&(0,s.jsx)("div",{className:"alert alert-danger",children:l}),(0,s.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,s.jsxs)("div",{className:"w-50",children:[(0,s.jsx)("label",{className:"form-label",children:"Email"}),(0,s.jsx)("input",{className:"form-control form-control-lg",type:"email",placeholder:"email@com.ua",value:e,onChange:e=>t(e.target.value),required:!0})]})}),(0,s.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,s.jsxs)("div",{className:"w-50",children:[(0,s.jsx)("label",{className:"form-label",children:"Пароль"}),(0,s.jsx)("input",{className:"form-control form-control-lg",type:"password",placeholder:"",value:r,onChange:e=>a(e.target.value),required:!0})]})}),(0,s.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Увійти"})})]})})}var u=r(8148);function d(){return(0,s.jsxs)("div",{className:"d-block",children:[(0,s.jsx)(u.A,{href:"/income",color:"primary",text:"Дохід"}),(0,s.jsx)(u.A,{href:"/expense",color:"primary",text:"Витрати"}),(0,s.jsx)(u.A,{href:"/statistic",color:"primary",text:"Статистика"}),(0,s.jsx)(u.A,{href:"/balance",color:"primary",text:"Баланс"})]})}var m=r(4091);function f(){let[e,t]=(0,n.useState)(!1),[r,c]=(0,n.useState)(!0);return((0,n.useEffect)(()=>{!async function(){try{await (0,a.T5)()?t(!0):((0,a.e4)(),t(!1)),c(!1)}catch(e){(0,a.e4)(),t(!1),c(!1)}}()},[]),console.log("Рендеринг Home:","isLoading:",r,"isAuthenticated:",e),r)?(0,s.jsx)(m.A,{}):(0,s.jsxs)("div",{className:"container",children:[(0,s.jsx)("div",{className:"m-5 text-center",children:(0,s.jsx)("p",{className:"h1",children:"LiVi Analytics"})}),e?(0,s.jsx)(d,{}):(0,s.jsx)(l,{})]})}},2378:(e,t,r)=>{"use strict";function s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)e[s]=r[s]}return e}r.d(t,{A:()=>n});var n=function e(t,r){function n(e,n,a){if("undefined"!=typeof document){"number"==typeof(a=s({},r,a)).expires&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var i in a)a[i]&&(c+="; "+i,!0!==a[i]&&(c+="="+a[i].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+c}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],s={},n=0;n<r.length;n++){var a=r[n].split("="),c=a.slice(1).join("=");try{var i=decodeURIComponent(a[0]);if(s[i]=t.read(c,i),e===i)break}catch(e){}}return e?s[e]:s}},remove:function(e,t){n(e,"",s({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,s({},this.attributes,t))},withConverter:function(t){return e(s({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},2979:(e,t,r)=>{Promise.resolve().then(r.bind(r,2093))},4091:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(5155);function n(e){let{header:t=!0}=e;return(0,s.jsxs)("div",{className:"container",children:[t?(0,s.jsx)("div",{className:"m-5 text-center",children:(0,s.jsx)("p",{className:"h1",children:"LiVi Analytics"})}):"",(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"spinner-border text-success",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden"})}),(0,s.jsx)("h3",{children:"Завантаження..."})]})]})}},4964:(e,t,r)=>{"use strict";r.d(t,{Ou:()=>l,T5:()=>c,e4:()=>i,h5:()=>o});var s=r(2378),n=r(5576);function a(){let e=s.A.get("supabase-auth-token");return e||null}async function c(){try{let t,r=a();try{if(!(t=JSON.parse(r)).access_token||!t.refresh_token)return!1}catch(e){return!1}let{data:{session:c},error:i}=await n.DB.auth.setSession({access_token:t.access_token,refresh_token:t.refresh_token});if(!i)return c;{var e;let{data:r,error:a}=await n.DB.auth.refreshSession({refresh_token:t.refresh_token});if(a)return!1;return e=c,s.A.set("supabase-auth-token",JSON.stringify(e),{expires:1,path:"/",secure:!0,sameSite:"Strict"}),r.session}}catch(e){return console.error("Помилка перевірки автентифікації:",e.message,e.line),!1}}function i(){s.A.remove("supabase-auth-token",{path:"/"})}async function o(e,t){let r={data:null,error:""};try{if(!await c())return r.error="Користувач не авторизований",r;let{data:s,error:a}=await n.DB.from(n.B.main).select("*").gte("created_at",e).lte("created_at",t);if(a)return r.error="Помилка отримання даних із ".concat(table,":"),a.message,r;r.data=s}catch(e){r.error="Виняток у fetchData: "+e.message}return r}async function l(e,t,r,s,i){try{if(!await c())throw"Користувач не авторизований";let o=JSON.parse(a()),l={sum:t,type:r,user_id:o.user.id,created_at:new Date(e),category:s||null,comment:i||null},{error:u}=await n.DB.from(n.B.main).insert([l]);if(u)throw u;return!0}catch(e){return console.error("Помилка запиту:",e.message),!1}}},5576:(e,t,r)=>{"use strict";r.d(t,{B:()=>n,DB:()=>s,L:()=>a});let s=(0,r(2659).UU)("https://vntunuzrneoakdckqjvk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZudHVudXpybmVvYWtkY2txanZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTI5NzEsImV4cCI6MjA2NzI4ODk3MX0.CWJIVqq-x5_doDk8rsl8ZJWP7um9VakuIDBihcfsrsU"),n={main:"fin_statistic",balance:"fin_balance"},a={pr:"Продукти",cf:"Кафе",cm:"Кумунальні платежі",md:"Аптека",eva:"Eva/Makeup",zoo:"Зоотовари",cl:"Одяг",usd:"Валюта",ot:"Інше"}},8148:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(5155),n=r(2619),a=r.n(n);function c(e){let{href:t,text:r,color:n}=e;return(0,s.jsx)("div",{className:"text-center p-2",children:(0,s.jsx)(a(),{href:t,className:"btn btn-".concat(n," btn-menu fs-4 fw-bold"),children:r})})}}},e=>{e.O(0,[619,40,441,255,358],()=>e(e.s=2979)),_N_E=e.O()}]);