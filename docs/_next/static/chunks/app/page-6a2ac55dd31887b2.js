(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2979:(e,s,t)=>{Promise.resolve().then(t.bind(t,5835))},5835:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var a=t(5155),r=t(2115),n=t(2378);let c=(0,t(2659).UU)("https://vntunuzrneoakdckqjvk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZudHVudXpybmVvYWtkY2txanZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTI5NzEsImV4cCI6MjA2NzI4ODk3MX0.CWJIVqq-x5_doDk8rsl8ZJWP7um9VakuIDBihcfsrsU");var l=t(63);function i(){let[e,s]=(0,r.useState)(""),[t,i]=(0,r.useState)(""),[o,u]=(0,r.useState)(null);(0,l.useRouter)();let h=async s=>{s.preventDefault(),u(null);try{let{data:s,error:a}=await c.auth.signInWithPassword({email:e,password:t});if(a)return void u(a.message);n.A.set("supabase-auth-token",JSON.stringify(s.session),{expires:1,path:"/",secure:!0,sameSite:"Strict"}),location.reload()}catch(e){u("Помилка авторизації: "+e.message)}};return(0,a.jsx)("div",{className:"d-block",children:(0,a.jsxs)("form",{onSubmit:h,children:[o&&(0,a.jsx)("div",{className:"alert alert-danger",children:o}),(0,a.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,a.jsxs)("div",{className:"w-50",children:[(0,a.jsx)("label",{className:"form-label",children:"Email"}),(0,a.jsx)("input",{className:"form-control form-control-lg",type:"email",placeholder:"email@com.ua",value:e,onChange:e=>s(e.target.value),required:!0})]})}),(0,a.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,a.jsxs)("div",{className:"w-50",children:[(0,a.jsx)("label",{className:"form-label",children:"Пароль"}),(0,a.jsx)("input",{className:"form-control form-control-lg",type:"password",placeholder:"",value:t,onChange:e=>i(e.target.value),required:!0})]})}),(0,a.jsx)("div",{className:"d-flex justify-content-center m-4",children:(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Увійти"})})]})})}var o=t(2619),u=t.n(o);function h(e){let{href:s,text:t,color:r}=e;return(0,a.jsx)("div",{className:"text-center p-2",children:(0,a.jsx)(u(),{href:s,className:"btn btn-".concat(r," btn-menu fs-4 fw-bold"),children:t})})}function d(){return(0,a.jsxs)("div",{className:"d-block",children:[(0,a.jsx)(h,{href:"/income",color:"primary",text:"Дохід"}),(0,a.jsx)(h,{href:"/expense",color:"primary",text:"Витрати"}),(0,a.jsx)(h,{href:"/statistic",color:"primary",text:"Статистика"}),(0,a.jsx)(h,{href:"/balance",color:"primary",text:"Баланс"})]})}function m(){let[e,s]=(0,r.useState)(!1),[t,l]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{!async function(){try{let e,t=n.A.get("supabase-auth-token");if(!t){s(!1),l(!1);return}try{e=JSON.parse(t)}catch(e){n.A.remove("supabase-auth-token",{path:"/"}),s(!1),l(!1);return}if(!e.access_token||!e.refresh_token){n.A.remove("supabase-auth-token",{path:"/"}),s(!1),l(!1);return}let{data:{session:a},error:r}=await c.auth.setSession({access_token:e.access_token,refresh_token:e.refresh_token});if(r){let{data:t,error:a}=await c.auth.refreshSession({refresh_token:e.refresh_token});if(a){n.A.remove("supabase-auth-token",{path:"/"}),s(!1),l(!1);return}n.A.set("supabase-auth-token",JSON.stringify(t.session),{expires:1,path:"/",secure:!0,sameSite:"Strict"}),s(!0)}else a&&s(!0);l(!1)}catch(e){n.A.remove("supabase-auth-token",{path:"/"}),s(!1),l(!1)}}()},[]),t)?(0,a.jsxs)("div",{className:"container",children:[(0,a.jsx)("div",{className:"m-5 text-center",children:(0,a.jsx)("p",{className:"h1",children:"МАФІН"})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"spinner-border text-success",role:"status",children:(0,a.jsx)("span",{className:"visually-hidden"})}),(0,a.jsx)("h3",{children:"Завантаження..."})]})]}):(0,a.jsxs)("div",{className:"container",children:[(0,a.jsx)("div",{className:"m-5 text-center",children:(0,a.jsx)("p",{className:"h1",children:"МАФІН"})}),e?(0,a.jsx)(d,{}):(0,a.jsx)(i,{})]})}}},e=>{e.O(0,[619,674,441,255,358],()=>e(e.s=2979)),_N_E=e.O()}]);